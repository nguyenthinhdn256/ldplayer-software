"use strict";(self.webpackChunk_tonkeeper_extension=self.webpackChunk_tonkeeper_extension||[]).push([[975],{75975:(e,n,t)=>{t.r(n),t.d(n,{LedgerContent:()=>v,default:()=>b});var s,r,o,a=t(30168),i=t(80184),l=t(72791),c=t(23098),d=t(61945),u=t(89242),m=t(88754),p=t(29681),h=t(65867),x=t(13994),g=t(35281);const f=h.ZP.div(s||(s=(0,a.Z)(["\n    display: flex;\n    align-items: center;\n    flex-direction: column;\n"]))),C=(0,h.ZP)(x.D)(r||(r=(0,a.Z)(["\n    margin: 1rem 0;\n"]))),k=h.ZP.div(o||(o=(0,a.Z)(["\n    margin-top: 1rem;\n    display: flex;\n    gap: 8px;\n    width: 100%;\n\n    > * {\n        flex: 1;\n    }\n"]))),v=e=>{let{ledgerParams:n,onClose:t,onSubmit:s}=e;const{t:r}=(0,d.$G)(),[o,a]=(0,l.useState)(!1),{mutateAsync:c,data:u,isLoading:h,isDeviceConnected:x,reset:v}=(0,p.KO)(),b=()=>{c().then((e=>e.signTransaction(n.path,n.transaction).then((e=>{a(!0),setTimeout((()=>s(e)),500)})).catch((e=>{console.error(e),"object"===typeof e&&"message"in e&&e.message.includes("0x6985")?t(new g.T("Cancel auth request")):t(e)})))).catch(console.debug)};(0,l.useEffect)((()=>{b()}),[]);let w="connect";return x&&(w="open-ton"),u&&(w="confirm-tx"),o&&(w="all-completed"),(0,i.jsxs)(f,{children:[(0,i.jsx)(C,{showConfirmTxStep:!0,currentStep:w}),(0,i.jsxs)(k,{children:[(0,i.jsx)(m.zx,{secondary:!0,onClick:()=>t(new g.T("Cancel auth request")),children:r("cancel")}),(0,i.jsx)(m.zx,{primary:!0,loading:h||!!u||o,onClick:()=>{v(),b()},children:r("try_again")})]})]})},b=()=>{const e=(0,c._)(),{t:n}=(0,d.$G)(),[t,s]=(0,l.useState)(void 0),[r,o]=(0,l.useState)(void 0),a=(0,l.useCallback)((()=>{s(void 0),o(void 0)}),[]),m=(0,l.useCallback)((n=>{e.uiEvents.emit("response",{method:"response",id:r,params:n}),a()}),[e,r,a]),p=(0,l.useCallback)((n=>{r&&e.uiEvents.emit("response",{method:"response",id:r,params:null!==n&&void 0!==n?n:new Error("Unknown Ledger error")}),a()}),[r,e,a]);(0,l.useEffect)((()=>{const n=e=>{s(e.params),o(e.id)};return e.uiEvents.on("ledger",n),()=>{e.uiEvents.off("ledger",n)}}),[e]);const h=(0,l.useCallback)((()=>{if(t&&r)return(0,i.jsx)(v,{ledgerParams:t,onClose:p,onSubmit:m})}),[e,t,r,p,m]);return(0,i.jsx)(u.P_,{isOpen:null!=t&&null!=r,handleClose:()=>p(new g.T("Cancel auth request")),title:n("ledger_connect_header"),children:h})}}}]);
//# sourceMappingURL=975.2e104cdc.chunk.js.map