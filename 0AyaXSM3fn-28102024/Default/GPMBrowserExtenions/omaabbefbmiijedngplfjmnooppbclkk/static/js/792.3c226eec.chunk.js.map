{"version":3,"file":"static/js/792.3c226eec.chunk.js","mappings":"uTAcA,MAAMA,EAAgBC,EAAAA,MAAW,IAAM,iCAqDvC,EApDiBC,KACb,MAAMC,GAASC,EAAAA,EAAAA,MACTC,GAAUC,EAAAA,EAAAA,MACVC,GAAMC,EAAAA,EAAAA,OACN,WAAEC,IAAeC,EAAAA,EAAAA,MACjBC,GAAMC,EAAAA,EAAAA,QAAO,OACXC,UAAWC,EAAcC,cAAeC,EAAkBC,YAAaC,EAAgBC,mBAAoBC,EAAuBC,KAAMC,IAAcC,EAAAA,EAAAA,kBAAiB,CAC3KC,SAAU,CAACrB,EAAOsB,WAAYC,EAAAA,GAASC,SAAU,MAAOtB,GACxDuB,QAASC,IAAA,IAAC,UAAEC,GAAuBD,EAAA,OAAK,IAAIE,EAAAA,IAAYxB,EAAIyB,UAAUC,iBAAiB,CACnFC,UAAW/B,EAAOsB,WAClBU,MAAO,GACPC,SAAUN,EACVO,aAAa,GACf,EACFC,iBAAkBC,GAAaA,EAASC,SAAW,EAAID,EAASC,cAAWC,IAEzEC,GAASC,EAAAA,EAAAA,kBACTC,GAAaC,EAAAA,EAAAA,cAAY,IACpBH,EAAOI,kBAAkB,CAAC3C,EAAOsB,WAAYC,EAAAA,GAASC,SAAU,SACxE,KACHoB,EAAAA,EAAAA,IAAiBpC,EAAK,IAAMiC,GAkB5B,MAAMzB,EAAqBC,GAC3B4B,EAAAA,EAAAA,GAAa9B,EAAgBC,EAAoBH,EAAkBP,EAAYE,GAE/E,MAAMgB,GAAWsB,EAAAA,EAAAA,UAAQ,KACdC,EAAAA,EAAAA,GAAuB5B,OAAWmB,IAC1C,CAACnB,IACJ,OAAKR,EAGmB,IAApBa,EAASwB,QACDC,EAAAA,EAAAA,KAAKC,EAAAA,SAAU,CAAEC,UAAUF,EAAAA,EAAAA,KAAKG,EAAAA,GAAsB,CAAC,GAAIC,UAAUJ,EAAAA,EAAAA,KAAKpD,EAAe,CAAC,MAE9FyD,EAAAA,EAAAA,MAAMC,EAAAA,SAAW,CAAEF,SAAU,EAACJ,EAAAA,EAAAA,KAAKO,EAAAA,GAAgB,CAAC,IAAIF,EAAAA,EAAAA,MAAMG,EAAAA,GAAW,CAAEjD,IAAKA,EAAK6C,SAAU,EAACJ,EAAAA,EAAAA,KAAKS,EAAAA,EAAoB,CAAEC,MAAOnC,GAAYA,EAAS,GAAG,IAAKR,IAAsBiC,EAAAA,EAAAA,KAAKW,EAAAA,GAAwB,CAAEC,KAAM,WALvNZ,EAAAA,EAAAA,KAAKG,EAAAA,GAAsB,CAAC,EAKuM,C","sources":["../../../packages/uikit/dist/pages/activity/Activity.js"],"sourcesContent":["import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { useInfiniteQuery, useQueryClient } from '@tanstack/react-query';\nimport { AccountsApi } from '@tonkeeper/core/dist/tonApiV2';\nimport React, { Suspense, useCallback, useMemo, useRef } from 'react';\nimport { InnerBody } from '../../components/Body';\nimport { ActivityHeader } from '../../components/Header';\nimport { ActivitySkeletonPage, SkeletonListWithImages } from '../../components/Skeleton';\nimport { MixedActivityGroup } from '../../components/activity/ActivityGroup';\nimport { useAppContext } from '../../hooks/appContext';\nimport { useFetchNext } from '../../hooks/useFetchNext';\nimport { QueryKey } from '../../libs/queryKey';\nimport { getMixedActivityGroups } from '../../state/mixedActivity';\nimport { useActiveApi, useActiveTonNetwork, useActiveWallet } from '../../state/wallet';\nimport { useScrollMonitor } from '../../state/activity';\nconst EmptyActivity = React.lazy(() => import('../../components/activity/EmptyActivity'));\nconst Activity = () => {\n    const wallet = useActiveWallet();\n    const network = useActiveTonNetwork();\n    const api = useActiveApi();\n    const { standalone } = useAppContext();\n    const ref = useRef(null);\n    const { isFetched: isTonFetched, fetchNextPage: fetchTonNextPage, hasNextPage: hasTonNextPage, isFetchingNextPage: isTonFetchingNextPage, data: tonEvents } = useInfiniteQuery({\n        queryKey: [wallet.rawAddress, QueryKey.activity, 'all', network],\n        queryFn: ({ pageParam = undefined }) => new AccountsApi(api.tonApiV2).getAccountEvents({\n            accountId: wallet.rawAddress,\n            limit: 20,\n            beforeLt: pageParam,\n            subjectOnly: true\n        }),\n        getNextPageParam: lastPage => (lastPage.nextFrom > 0 ? lastPage.nextFrom : undefined)\n    });\n    const client = useQueryClient();\n    const invalidate = useCallback(() => {\n        return client.invalidateQueries([wallet.rawAddress, QueryKey.activity, 'all']);\n    }, []);\n    useScrollMonitor(ref, 5000, invalidate);\n    // const {\n    //     isFetched: isTronFetched,\n    //     data: tronEvents,\n    //     isFetchingNextPage: isTronFetchingNextPage,\n    //     hasNextPage: hasTronNextPage,\n    //     fetchNextPage: fetchTronNextPage\n    // } = useInfiniteQuery({\n    //     queryKey: [wallet.tron?.ownerWalletAddress, wallet.network, QueryKey.tron],\n    //     queryFn: ({ pageParam = undefined }) =>\n    //         new TronApi(api.tronApi).getTransactions({\n    //             ownerAddress: wallet.tron!.ownerWalletAddress,\n    //             fingerprint: pageParam,\n    //             limit: 100\n    //         }),\n    //     getNextPageParam: lastPage => lastPage.fingerprint,\n    //     enabled: wallet.tron !== undefined\n    // });\n    const isFetchingNextPage = isTonFetchingNextPage;\n    useFetchNext(hasTonNextPage, isFetchingNextPage, fetchTonNextPage, standalone, ref);\n    //  useFetchNext(hasTronNextPage, isFetchingNextPage, fetchTronNextPage, standalone, ref);\n    const activity = useMemo(() => {\n        return getMixedActivityGroups(tonEvents, undefined);\n    }, [tonEvents]);\n    if (!isTonFetched) {\n        return _jsx(ActivitySkeletonPage, {});\n    }\n    if (activity.length === 0) {\n        return (_jsx(Suspense, { fallback: _jsx(ActivitySkeletonPage, {}), children: _jsx(EmptyActivity, {}) }));\n    }\n    return (_jsxs(_Fragment, { children: [_jsx(ActivityHeader, {}), _jsxs(InnerBody, { ref: ref, children: [_jsx(MixedActivityGroup, { items: activity }, activity[0][0]), isFetchingNextPage && _jsx(SkeletonListWithImages, { size: 3 })] })] }));\n};\nexport default Activity;\n"],"names":["EmptyActivity","React","Activity","wallet","useActiveWallet","network","useActiveTonNetwork","api","useActiveApi","standalone","useAppContext","ref","useRef","isFetched","isTonFetched","fetchNextPage","fetchTonNextPage","hasNextPage","hasTonNextPage","isFetchingNextPage","isTonFetchingNextPage","data","tonEvents","useInfiniteQuery","queryKey","rawAddress","QueryKey","activity","queryFn","_ref","pageParam","AccountsApi","tonApiV2","getAccountEvents","accountId","limit","beforeLt","subjectOnly","getNextPageParam","lastPage","nextFrom","undefined","client","useQueryClient","invalidate","useCallback","invalidateQueries","useScrollMonitor","useFetchNext","useMemo","getMixedActivityGroups","length","_jsx","Suspense","fallback","ActivitySkeletonPage","children","_jsxs","_Fragment","ActivityHeader","InnerBody","MixedActivityGroup","items","SkeletonListWithImages","size"],"sourceRoot":""}