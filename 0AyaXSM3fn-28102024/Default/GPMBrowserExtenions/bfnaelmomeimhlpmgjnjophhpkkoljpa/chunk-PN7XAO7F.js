import{e as Ni}from"./chunk-2MSBWT3V.js";import{$ as bt,$b as Zt,Aa as Ci,Bb as Ii,C as ii,Ca as bi,F as ni,Fa as yi,G as dt,J as ri,K as je,Ka as Si,L as Fe,La as gi,Lb as Pi,M as si,Mb as Di,N as li,Nb as ki,Qb as Ui,Ra as hi,T as ai,Wa as ze,Xa as Ti,Yb as we,Z as ft,_ as Ct,_b as Ce,ac as $e,dc as Jt,ea as ci,ec as Ri,fc as Ye,hc as eo,ia as ui,ic as St,jc as Li,ka as Jr,la as pi,m as We,ma as mi,mb as Ai,nb as xi,nc as Bi,o as Yo,q as Xo,r as Zo,sb as wi,sc as Mi,t as mt,tb as Ei,u as Jo,vc as Oi,w as ei,x as ti,xa as yt,xb as vi,ya as di,z as oi,za as fi}from"./chunk-TYXPKGSM.js";import{a as Wo,g as jo,o as zo}from"./chunk-OX7Q6J2U.js";import{C as $t,Da as Vo,Fa as st,Ja as Fo,L as ko,La as Me,Ma as lt,Na as v,O as ee,Oa as Ho,P as w,Pa as Oe,Q as k,T as ge,U as he,Vd as $o,Wd as Ve,Ya as _o,Za as at,bb as Ko,gb as ct,hb as qo,je as ut,kb as Go,lb as Qo,md as N,ne as pt,rd as Ne,uc as H}from"./chunk-MHD4HNLY.js";import{p as Re}from"./chunk-G3SOTMUM.js";import{a as Z,m as L}from"./chunk-56SJOU6P.js";import{V as Oo,_ as Yt,a as fe,b as R,c as Uo,da as Xt,f as Ro,fa as rt,ia as No,k as Lo,l as Le,o as Bo,p as Be,r as nt,s as Mo,x as U}from"./chunk-6E74REJW.js";import{ha as F,ja as O,ka as ie,sa as D,t as it}from"./chunk-66TF6S77.js";import{a as c}from"./chunk-4P36KWOF.js";import{a as T}from"./chunk-7X4NV6OJ.js";import{f as S,h as l,l as Zr,m as Buffer,n as a}from"./chunk-3KENBVE7.js";l();a();var $=e=>{if(e!=null&&!(e.constructor===Object&&Object.keys(e).length===0))return e},es=e=>e??[],te=class extends Error{constructor(t){super(t),this.name="CollectiblesError"}},I=c.string().nullish().transform($),Ee=c.number().nullish().transform($),to=c.union([I,Ee]).transform(e=>typeof e=="number"?e.toString():e),ts=c.object({name:I,symbol:I,decimals:Ee,address:I}),oo=(b=>(b[b.Uninitialized=0]="Uninitialized",b[b.EditionV1=1]="EditionV1",b[b.MasterEditionV1=2]="MasterEditionV1",b[b.ReservationListV1=3]="ReservationListV1",b[b.MetadataV1=4]="MetadataV1",b[b.ReservationListV2=5]="ReservationListV2",b[b.MasterEditionV2=6]="MasterEditionV2",b[b.EditionMarker=7]="EditionMarker",b[b.UseAuthorityRecord=8]="UseAuthorityRecord",b[b.CollectionAuthorityRecord=9]="CollectionAuthorityRecord",b[b.TokenOwnedEscrow=10]="TokenOwnedEscrow",b[b.TokenRecord=11]="TokenRecord",b[b.MetadataDelegate=12]="MetadataDelegate",b))(oo||{}),gt=c.nativeEnum(oo),Vi=c.object({price:c.number(),token:ts.nullish().transform($)}),os=Vi.nullish().transform($),is=c.object({name:I,url:I,isVerified:c.coerce.boolean()}),Fi=c.object({id:c.string(),isValidCollectionId:c.coerce.boolean(),name:I,description:I,externalUrl:I,imageUrl:I,isSpam:c.coerce.boolean(),spamStatus:c.nativeEnum(we).optional().default("NOT_VERIFIED"),floorPrice:Vi.nullish().transform($),ownerCount:Ee,totalCount:Ee,tokenCount:Ee,marketplaces:c.array(is)}),ns=c.object({small:I,medium:I,large:I,blurhash:I}),rs=ns.nullish().transform($),ss=c.enum(["image","video","audio","model","other"]),ls=c.object({url:I}),Xe=ls.nullish().transform($),as=c.object({type:ss,image:Xe,video:Xe,audio:Xe,model:Xe,other:Xe,previews:rs}),cs=as.nullish().transform($),us=c.object({trait_type:I,value:I.or(Ee),display_type:I}),ps=c.object({id:c.string(),contract:c.string(),standard:c.nativeEnum(Ti)}),io=c.object({compressed:c.boolean(),merkleTree:c.string(),leafIndex:c.number()}),ms=c.object({mint:c.string(),tokenAccount:c.string(),standard:c.nativeEnum(ze),compression:io.nullish().transform($),programId:c.string(),mintExtensions:Lo(hi).optional()}),ds=c.object({id:c.string(),url:c.string(),displayName:c.string(),description:c.string(),count:c.number()}),Hi=c.object({hash:c.string(),index:c.number(),distinctRareSats:c.number(),satributes:c.array(ds),blockNumber:c.number(),value:c.number(),backgroundImageUrl:c.string()}),fs=c.object({firstCreatedTransactionHash:c.string(),firstCreatedInscriptionId:c.string(),inscriptionId:I,inscriptionNumber:to,outputValue:to,satNumber:to,satName:I,satRarity:I,protocolName:I,utxoHash:I,utxoIndex:Ee,createdAt:c.string().nullish().transform($),utxoDetails:Hi.nullish().transform($)}),nc=c.object({firstCreatedTransactionHash:c.string(),firstCreatedInscriptionId:c.string(),utxoDetails:Hi}),Cs=c.object({listingPrice:c.string(),listingPriceUiAmount:c.string(),isNative:c.boolean(),url:c.string()}),bs=c.union([ms,ps,fs]),no=c.object({id:Ho,chain:Ko,name:I,symbol:I,description:I,externalUrl:I,collection:Fi,media:cs,uri:I,attributes:c.array(us).nullish().transform(es),lastSalePrice:os,balance:I,decimals:I,owner:I,chainData:bs.optional(),listings:c.record(Cs).nullish().transform($)}),ys=Fi.extend({items:c.array(no)}),rc=c.object({items:c.array(ys),isTrimmed:c.boolean()});var Ss=c.object({networkID:lt}),ht=Ss.extend({type:c.literal("transferSPLToken"),senderAddress:at,mint:c.string(),amount:c.union([c.instanceof(R),c.string()]),memo:c.string().optional()}),sc=ht.extend({destination:c.string(),senderAccount:c.string(),decimals:c.number(),references:c.array(c.string()).optional(),programId:c.string()}),lc=ht.extend({destination:c.string(),compression:io.nullish().transform($).refine(e=>e?.compressed)}),ac=c.object({compression:io.nullish().transform($).refine(e=>e?.compressed),mint:c.string()}),cc=ht.extend({destination:c.string(),senderAccount:c.string(),standard:c.enum(["ProgrammableNonFungible","ProgrammableNonFungibleEdition"])}),uc=ht.extend({destination:c.string()}),pc=c.object({root:c.string(),proof:c.array(c.string()),merkleTree:c.string(),dataHash:c.string(),creatorHash:c.string(),leafIndex:c.number(),owner:c.string(),delegate:c.string().optional()}),_i=c.object({networkID:Me}),mc=_i.extend({senderAddress:at,type:c.literal("transferERC721Evm"),destination:c.string(),amount:c.literal(1),contractAddress:c.string(),tokenID:c.string()}),dc=_i.extend({senderAddress:at,type:c.literal("transferERC1155Evm"),destination:c.string(),amount:c.union([c.instanceof(R),c.string()]),contractAddress:c.string(),tokenID:c.string()}),Ki=c.object({networkID:Fo}),fc=Ki.extend({type:c.literal("ordinal"),inscriptionId:c.string(),value:c.string(),senderAddress:c.string(),destination:c.string(),amount:c.literal(1),utxoHash:c.string(),utxoIndex:c.number()}),Cc=Ki.extend({type:c.literal("raresats"),hash:c.string(),index:c.number(),value:c.string(),senderAddress:c.string(),destination:c.string(),amount:c.literal(1)});l();a();function K(e){return e?.tokenAccount!==void 0}function ne(e){return e?.contract!==void 0}function re(e){return e!==void 0&&"firstCreatedTransactionHash"in e}function Tt(e){return re(e)&&!!e.utxoDetails}var qi=e=>e.type==="transferERC721Evm",Gi=e=>e.type==="transferERC1155Evm",Qi=e=>"compression"in e&&!!e.compression?.compressed,Wi=e=>"standard"in e&&(e.standard==="ProgrammableNonFungible"||e.standard==="ProgrammableNonFungibleEdition"),ji=e=>e.type==="transferSPLToken"&&"destination"in e,zi=e=>e.type==="ordinal",$i=e=>e.type==="raresats";l();a();l();a();var ro=S(Zr());l();a();var Yi=new w.PublicKey("NTYeYJ1wr4bpM5xo6zx5En44SvJFAd35zTxxNoERYqd"),wc=new w.PublicKey("M2mx93ekt1fmXSVkTrUL9xVFHkmME8HTUi5Cyc5aF7K"),Ec="https://magiceden.io/terms-of-service.pdf";var He=e=>{for(let t of e.instructions)for(let o of t.keys)if(o.isSigner&&o.pubkey.toBase58()===Yi.toBase58())return!0;return!1},pe=e=>{switch(e){case"mainnet-beta":return 101;case"testnet":return 102;case"devnet":return 103;case"localhost":return 101}},At=e=>new R(e).multipliedBy(w.LAMPORTS_PER_SOL).toNumber();function xt(e){let t=[2,6],o=gt.safeParse(e);return o.success&&t.includes(o.data)}var so=ro.Buffer.from("metadata"),gs=ro.Buffer.from("edition"),lo=We.toBuffer();function Bc(e){let[t]=w.PublicKey.findProgramAddressSync([so,lo,e],We);return t}function Xi(e){let[t]=w.PublicKey.findProgramAddressSync([so,lo,e,gs],We);return t}function Mc(e){let[t]=w.PublicKey.findProgramAddressSync([so,lo,e],We);return t}l();a();l();a();var oe=(e,t,o,i)=>{(!t||t>=400&&t<500)&&(D.addBreadcrumb(o,JSON.stringify(i),"info"),D.captureError(e,"collectibles"))};l();a();var wt=e=>{let t=!1;return{collectibles:e.reduce((i,n)=>{let r=no.safeParse(n);return r.success?i.push(r.data):t=!0,i},[]),containsParseFailure:t}};var hs="collectibles",Ts=new Error("Failed to fetch collectibles for addresses");async function Et(e){let t="/collectibles/v1";try{let i=(await k.api().post(t,{addresses:e})).data,n=!!i.isTrimmed;if(!i.collectibles)throw Ts;let{collectibles:r,containsParseFailure:s}=wt(i.collectibles);return s&&D.captureError(new Error("collectibles failed to parse some items"),"collectibles"),{allCollectibles:r,isTrimmed:n}}catch(o){if(he(o)){let i=o.response?.status;oe(o,i,hs)}throw o}}l();a();var Zi=new Error("Failed to fetch spl collectible marketplace stats"),ao=async(e,t,o)=>{let i=`/solana/nft/v1/mint/${e}/stats`,n=new URLSearchParams;n.set("chainId",t.toString()),o&&n.set("pubkey",o);let r;try{r=await k.api().headers({Accept:"application/json"}).get(`${i}?${n.toString()}`)}catch{throw Zi}if(!ge(r))throw Zi;return r.data.stats};l();a();var As="spl-listings",xs=new Error("Failed to fetch SPL listings"),vt=async e=>{let t;try{let o=e.chainId.replace("solana:",""),i=e.address,n=new URLSearchParams;n.append("chainId",o);let r=await k.api().headers({Accept:"application/json"}).get(`/solana/nft/v1/pubkey/${i}/listings?${n.toString()}`);if(t=r.status,!ge(r))throw xs;return r.data.filter(m=>!!m.listings?.magic_eden)}catch(o){let i=o instanceof Error?o:new Error("Non-Error was thrown during fetching of spl listings");throw oe(i,t,As),i}};var ws=U({seconds:10}),Es=U({seconds:5}),vs="CollectibleEdition";function Is(e,t){return O({queryKey:[vs,{mintAddress:e}],async queryFn(){if(!t)return{};let o=Buffer.from(new w.PublicKey(e).toBytes()),i=Xi(o),{Edition:n}=await Xo();try{let r=await n.fromAccountAddress(t,i),s=gt.safeParse(r.key);if(!s.success)throw new Error(`Invalid MetaplexTokenEdition: ${r.key}`);return{key:s.data,isMasterEdition:xt(r.key)}}catch{return{key:void 0,isMasterEdition:void 0}}}})}var Ps="SPLTokenAccountListingStats";function Ds(e,t,o){return O({enabled:t!=="",refetchInterval:ws,gcTime:Es,queryKey:[Ps,{cluster:e,mint:t,pubkey:o}],async queryFn({queryKey:i}){let[,{mint:n,cluster:r}]=i,s=pe(r);return await ao(n,s,o)}})}var ks=async(e,t,o,i,n=20,r=1e3)=>{try{let s=pe(t);return await Be(async()=>{let m=await ao(e,s);if(!m[o])return;let d=(m[o].activities??[]).find(f=>f.signature===i);if(!d)throw new Error("no activity with that signature yet!");return d},()=>!0,n,r)}catch{}},Us=async(e,t,o,i,n=20,r=1e3)=>{try{let s=pe(o);return await Be(async()=>{let m=await vt({address:e,chainId:`solana:${s}`});for(let p of m)if(p.listings?.[i]&&p.asset.mintPubKey===t)throw new Error("still in listings");return m},()=>!0,n,r)}catch{}},Rs=async(e,t,o=20,i=1e3)=>{try{return await Be(async()=>{let{allCollectibles:r}=await Et(e.map(ft));for(let s of r)if(K(s.chainData)&&s.chainData.mint===t)return s;throw new Error("cant find mint in tokens")},()=>!0,o,i)}catch{}};l();a();var uo=S(T());l();a();l();a();var Ls="collectibles",Ji=new Error("Failed to fetch collectibles details for addresses");async function en(e){let t="/collectibles/v1/collectibles-details",o;try{let i=await k.api().post(t,{addresses:e});if(o=i.status,!ge(i))throw Ji;let n=i.data;if(!n.collectibles)throw Ji;let{collectibles:r,containsParseFailure:s}=wt(n.collectibles);return s&&D.captureError(new Error("collectibles failed to parse some items"),"collectibles"),r}catch(i){let n=i instanceof Error?i:new Error("Non-Error was thrown during fetching of collectibles details");throw oe(n,o,Ls),n}}var tn=async e=>{let t=e.find(d=>v.isSolanaNetworkID(d.chainId));if(!t)throw new Error("no solana account");let{chainId:o}=t,i=await Be(()=>vt(t),()=>!0),n=i.reduce((d,f)=>({...d,[f.asset.mintPubKey]:f}),{}),r=i.map(d=>({chainId:o,address:d.asset.mintPubKey})),u=Uo(r,100).map(d=>en(d));return(await Promise.all(u)).flat().reduce((d,f)=>{if(!K(f.chainData))return d;let{asset:y,listings:b}=n[f.chainData.mint];return d.push({...f,chainData:{...f.chainData,tokenAccount:y.pubkey},...b?{listings:b}:{}}),d},[])};l();a();l();a();var nn=e=>{let t=[];for(let[o,i]of e){i.sort((r,s)=>{let u=r.name??"",m=s.name??"",p=u.localeCompare(m);if(u.localeCompare(m))return p;let d=on(r),f=on(s);return d.localeCompare(f)});let[n]=i;n&&t.push({..."externalUrl"in n?{externalUrl:n.externalUrl}:void 0,...n.collection,items:i})}return t.sort((o,i)=>{if(o.items.length>i.items.length)return-1;if(i.items.length>o.items.length)return 1;let n=o.name??o.id??"",r=i.name??i.id??"";return n.localeCompare(r)})};function on(e){let t=e.chainData;return K(t)?t.tokenAccount:ne(t)?t.id:(re(t),e.id)}function rn(e){let t=new Map;for(let o of e){let i=o.collection.id,n=t.get(i)??[];n.push(o),t.set(i,n)}return nn(t)}l();a();var sn=(e,t)=>{let o=[],i=new Set,n=[...e,...t];for(let r of n)i.has(r.id)||(o.push(r),i.add(r.id));return o};l();a();l();a();var le="collectibles",co=[le,"collectibleBids"],x={collections:e=>[le,"collections",{addresses:e.map(ft)}],hiddenCollections:e=>[le,"hiddenCollections",e],unhiddenCollections:e=>[le,"unhiddenCollections",e],visibilityOverrides:e=>[le,"visibilityOverrides",e],pinnedCollections:e=>[le,"pinnedCollections",e],optimisticUpdates:()=>[le,"optimisticUpdates"],collectibleBids:e=>[...co,e],collectibleMintGasEstimation:e=>[le,"mintNFTGasEstimation",e],collectibleSellSteps:e=>[le,"collectibleSellSteps",e],createMintTransaction:e=>[le,"createMintTransaction",e],transferTransaction:(e,t,o)=>[le,"transferTransaction",{transferArgs:e,transactionUnitCost:t,utxoState:o}]};var Bs=20;function _e(e,t){let o=x.optimisticUpdates(),i=e.getQueryData(o)??[];e.setQueryData(o,[...i,t])}async function ln(e,t){let o=x.optimisticUpdates(),i=await e.getQueryState(o);if(i){let n=t??Date.now(),r=i.dataUpdatedAt,s=U({seconds:Bs});return n-r>s?(e.removeQueries({queryKey:o}),[]):i?.data??[]}else return[]}function an(e,t){let o=t.reduce((i,n)=>{let{id:r,amount:s}=n,u=new R(s);return i[r]=(i[r]??new R(0)).plus(u),i},{});for(let i of e)i.items=i.items.reduce((n,r)=>{let s=r.id,u=o[s];if(u){let m=new R(r.balance??0);return m.minus(u).isGreaterThan(0)?n.concat({...r,balance:m.minus(u).toString()}):n}else return n.concat(r)},[]);return e=e.filter(i=>i.items.length>0),e}l();a();var ae=(n=>(n[n.Always=1/0]="Always",n[n.Short=U({days:1})]="Short",n[n.Medium=U({days:3})]="Medium",n[n.Long=U({days:7})]="Long",n))(ae||{}),me=(r=>(r[r.Immediate=0]="Immediate",r[r.Short=U({minutes:1})]="Short",r[r.Medium=U({minutes:2.5})]="Medium",r[r.Long=U({minutes:5})]="Long",r[r.Never=1/0]="Never",r))(me||{}),Ze=(u=>(u[u.Shortest=U({seconds:10})]="Shortest",u[u.Shorter=U({seconds:30})]="Shorter",u[u.Short=U({minutes:1})]="Short",u[u.Medium=U({minutes:2.5})]="Medium",u[u.Long=U({minutes:5})]="Long",u[u.Longer=U({minutes:7.5})]="Longer",u[u.Longest=U({minutes:10})]="Longest",u))(Ze||{});var cn=({addresses:e,queryOptions:t={staleTime:me.Short,refetchInterval:Ze.Long},select:o})=>{let i=F(),n=x.collections(e);return O({enabled:e.length!==0&&e.every(r=>!v.isLocalNetworkID(r.networkID)),queryKey:n,gcTime:ae.Medium,staleTime:t.staleTime,refetchInterval:t.refetchInterval,async queryFn({queryKey:[,,{addresses:r}]}){let[s,u]=await Promise.allSettled([tn(r),Et(r)]);if(u.status==="rejected")throw new Error("failed to load unlisted collections");let{allCollectibles:m,isTrimmed:p}=u.status==="fulfilled"?u.value:{allCollectibles:[],isTrimmed:!1},d=s.status==="fulfilled"?s.value:[],f=sn(d,m),y=rn(f),b=await ln(i),g=an(y,b);return{items:g,nrOfItems:g.reduce((h,A)=>h+A.items.length,0),isTrimmed:p}},select:o})},ve=e=>cn({...e,select:(0,uo.useCallback)(t=>t.items,[])}),Ms=e=>cn({...e,select:(0,uo.useCallback)(o=>o.isTrimmed,[])}).data??!1;l();a();l();a();var po=class extends te{constructor(t){super(t),this.name="GetPinnedCollectionsError"}};async function It(e){try{return await e.get("pinnedCollections")}catch{throw new po("")}}var mo=class extends te{constructor(t){super(t),this.name="SetPinnedCollectionsError"}};async function fo(e,t){try{return await e.set("pinnedCollections",t)}catch{throw new mo("")}}var Pt=e=>{let t=N();return O({enabled:e.length!==0,queryKey:x.pinnedCollections(e),gcTime:ae.Long,staleTime:1/0,refetchInterval:!1,refetchOnMount:!0,async queryFn(){try{return(await It(t)??{})[e]||[]}catch(o){return o instanceof Error&&D.captureError(o,"collectibles"),[]}}})};l();a();var un=S(T());var Os=({id:e,addresses:t})=>{let{data:o,isSuccess:i}=ve({addresses:t});return(0,un.useMemo)(()=>{let r={isSuccess:i,data:void 0};for(let s of o??[])for(let u of s.items)if(u.id===e)return{...r,data:u};return r},[e,o,i])};l();a();var W=S(T());l();a();function Y(e){let t=N();return O({gcTime:ae.Long,staleTime:1/0,enabled:!!e,queryKey:x.visibilityOverrides(e??""),async queryFn(){return e?await Ce(t,e):new Map}})}l();a();var Pe=S(T());l();a();function Ie(){let e=N(),t=F(),o=H();return ie({async mutationFn({accountId:i,mutations:n}){await $e(e,o,{accountId:i,mutations:n})},async onSuccess(i,{accountId:n}){await t.invalidateQueries({queryKey:x.visibilityOverrides(n)}),await Promise.allSettled([t.invalidateQueries({queryKey:x.hiddenCollections(n)}),t.invalidateQueries({queryKey:x.unhiddenCollections(n)})])}})}async function kt({collectible:e,visibilityOverrides:t,setVisibilityOverrides:o,accountId:i,desiredVisibility:n,onSuccess:r,onError:s}){if(!t)return;let u=e.collection.id||e.id,m=t.get(u)?.status;try{let p=mn(n,e.collection);await o({accountId:i,mutations:[{id:u,visibility:p}]}),await r({collectible:e,desiredVisibility:n,previousVisibility:m,updatedVisibility:p})}catch(p){await s(p,{collectible:e,desiredVisibility:n})}}async function pn({collection:e,visibilityOverrides:t,setVisibilityOverrides:o,accountId:i,desiredVisibility:n,onSuccess:r,onError:s}){if(!t)return;let u=e.id,m=t.get(u)?.status;try{let p=mn(n,e);await o({accountId:i,mutations:[{id:u,visibility:p}]}),r&&await r({collection:e,desiredVisibility:n,previousVisibility:m,updatedVisibility:p})}catch(p){s&&await s(p,{collection:e,desiredVisibility:n})}}function mn(e,t){let{spamStatus:o}=t;switch(e){case"hidden:reported_spam":if(o==="NOT_VERIFIED"||o==="VERIFIED")return"hidden:reported_spam";if(o==="POSSIBLE_SPAM"||o==="SPAM")return null;throw new Error(`Unexpected spam status: ${o} found while marking spam.`);case"visible:reported_notSpam":if(o==="NOT_VERIFIED"||o==="VERIFIED")return null;if(o==="POSSIBLE_SPAM"||o==="SPAM")return"visible:reported_notSpam";throw new Error(`Unexpected spam status: ${o} found while marking not spam.`);case"hidden":if(o==="NOT_VERIFIED"||o==="VERIFIED")return"hidden";if(o==="POSSIBLE_SPAM"||o==="SPAM")return null;throw new Error(`Unexpected spam status: ${o} found while marking hidden.`);case"visible":if(o==="NOT_VERIFIED"||o==="VERIFIED")return null;if(o==="POSSIBLE_SPAM"||o==="SPAM")return"visible";throw new Error(`Unexpected spam status: ${o} found while marking visible.`)}throw new Error(`Unexpected desired visibility: ${e} found while calculating new visibility.`)}function Te(e){return{networkId:e.chain.id,chainId:v.getChainID(e.chain.id),collectionId:e.collection.id,collectibleId:e.id,collectibleName:e.name,collectibleDescription:e.description,collectionName:e.collection.name,collectionDescription:e.collection.description,collectionUrl:e.collection.externalUrl}}function dn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=Ie();return(0,Pe.useCallback)(async r=>{await kt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"hidden:reported_spam",onSuccess:o,onError:t})},[i,n,e,t,o])}function fn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=Ie();return(0,Pe.useCallback)(async r=>{await kt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"visible:reported_notSpam",onSuccess:o,onError:t})},[i,n,e,t,o])}function Cn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=Ie();return(0,Pe.useCallback)(async r=>{await kt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"hidden",onSuccess:o,onError:t})},[i,n,e,t,o])}function bn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=Ie();return(0,Pe.useCallback)(async r=>{await kt({collectible:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"visible",onSuccess:o,onError:t})},[i,n,e,t,o])}function yn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=Ie();return(0,Pe.useCallback)(async r=>{await pn({collection:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"hidden",onSuccess:o,onError:t})},[i,n,e,t,o])}function Sn({accountId:e,onError:t,onSuccess:o}){let{data:i}=Y(e),{mutateAsync:n}=Ie();return(0,Pe.useCallback)(async r=>{await pn({collection:r,visibilityOverrides:i,setVisibilityOverrides:n,accountId:e,desiredVisibility:"visible",onSuccess:o,onError:t})},[i,n,e,t,o])}l();a();var Co=S(T());var gn=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,Co.useCallback)(({collectible:s,updatedVisibility:u})=>{u!==null&&i.capture("collectionHidden",{data:Te(s)}),e&&e.success(o("collectionHideSuccess"))},[o,e,i]),r=(0,Co.useCallback)((s,u)=>{e&&e.error(o("collectionHideFail"))},[o,e]);return Cn({accountId:t,onSuccess:n,onError:r})};l();a();var bo=S(T());var hn=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,bo.useCallback)(({collectible:s,updatedVisibility:u})=>{u!==null&&i.capture("collectionUnhidden",{data:Te(s)}),e&&e.success(o("collectionUnhideSuccess"))},[o,e,i]),r=(0,bo.useCallback)((s,u)=>{e&&e.error(o("collectionUnhideFail"))},[o,e]);return bn({accountId:t,onSuccess:n,onError:r})};function Ns({accountId:e,collectible:t,toast:o}){let i=gn({accountId:e,toast:o}),n=(0,W.useCallback)(()=>{if(t)return i(t)},[i,t]),r=hn({accountId:e,toast:o}),s=(0,W.useCallback)(()=>{if(t)return r(t)},[r,t]),{data:u}=Y(e??""),m=(0,W.useMemo)(()=>u?.get(t?.collection.id??t?.id??""),[u,t]),p=(0,W.useMemo)(()=>t?St(m,{spamStatus:t.collection.spamStatus}):!1,[t,m]),d=(0,W.useCallback)(()=>p?s():n(),[p,n,s]);return(0,W.useMemo)(()=>({isHidden:p,onHideCollectible:n,onUnhideCollectible:s,onToggleHide:d}),[n,d,s,p])}function Vs(e){let{data:t,isPending:o}=Y(e),i=(0,W.useCallback)(s=>{if(!s)return!1;let u=s.collection.id||s.id;return eo(t,{spamStatus:s.collection.spamStatus,key:u})},[t]),n=(0,W.useCallback)(s=>{if(!s)return"NOT_VERIFIED";let u=s.collection.id||s.id;return Jt(t,{spamStatus:s.collection.spamStatus,key:u})},[t]),r=(0,W.useCallback)(s=>Ye(n(s)),[n]);return(0,W.useMemo)(()=>({getIsHidden:i,getSpamStatus:n,getIsSpam:r,isLoading:o}),[i,n,r,o])}function Tn(e){let{data:t,isPending:o}=Y(e),i=(0,W.useCallback)(s=>{if(!s)return!1;let u=s.id;return eo(t,{spamStatus:s.spamStatus,key:u})},[t]),n=(0,W.useCallback)(s=>{if(!s)return"NOT_VERIFIED";let u=s.id;return Jt(t,{spamStatus:s.spamStatus,key:u})},[t]),r=(0,W.useCallback)(s=>Ye(n(s)),[n]);return(0,W.useMemo)(()=>({getIsHidden:i,getSpamStatus:n,getIsSpam:r,isLoading:o}),[i,n,r,o])}function An(e){let t=Tn(e),o=yn({accountId:e}),i=Sn({accountId:e});return(0,W.useMemo)(()=>({...t,hideCollection:o,unhideCollection:i}),[t,o,i])}l();a();var xn=S(T());var Fs=({id:e,addresses:t})=>{let{data:o}=ve({addresses:t});return(0,xn.useMemo)(()=>(o??[]).find(i=>i.id===e),[e,o])};l();a();var wn=S(T()),Ut=(e,t)=>(0,wn.useMemo)(()=>t?e.includes(t):!1,[t,e]);l();a();var Mm=e=>`${e/100}%`,En=(e,t)=>e*t/100/100;l();a();var kn=S(Yt()),De=S(T());l();a();var Hs=c.object({caip19:c.string(),name:c.string(),symbol:c.string()}),In=c.object({bps:c.number(),kind:c.union([c.literal("marketplace"),c.literal("royalty")]),recipient:c.string().optional()}),_s=c.object({amount:c.number(),feeBreakdown:c.array(In),netAmount:c.number(),token:Hs,totalFeeBps:c.number()}),Ks=c.object({name:c.string(),logo:c.string(),url:c.string().optional()}),Pn=c.object({id:c.string(),expiration:c.string().optional(),price:_s,source:Ks}),qs=c.object({bids:c.array(Pn)}),vn=new te("Failed to fetch collectible bids."),Gs="collectible-instant-sell-bids",Qs=async e=>{if(!e.address)throw vn;try{let t=await k.api().validateStatus(!0).post("/collectibles/v1/bids",{asset:e}),{bids:o}=qs.parse(t.data);return o}catch(t){if(he(t)){let o=t.response?.status;oe(t,o,Gs)}throw vn}},yo=({bidAsset:e,isEnabled:t})=>{let o=t&&e.address!==null&&e.chainId!==null;return O({enabled:o,staleTime:me.Short,refetchInterval:Ze.Shortest,queryKey:x.collectibleBids(e),async queryFn(){return Qs(e)}})},Rt=e=>{let t=e?.chainData,o=e?.chain.id??null,i=ne(t),n=K(t),r=i?{tokenId:t.id}:{},s=n?{contractType:t.standard}:{},u=i?t.contract.toLowerCase():n?t.mint:null;return{chainId:o,address:u,resourceType:"address",...r,...s}};l();a();var Ws=S(T());var _=c.enum(["auth","nft-approval","sale","order-signature","refetch","blur-swap","update-proof"]),js=c.enum(["/execute/auth-signature/v1","/order/v3"]),de=c.enum(["transaction","signature","post","refetch"]),zs=c.enum(["eip712","eip191"]),$s=c.object({domain:c.any(),types:c.any(),value:c.any()}),Ys=c.object({message:c.string()}),Xs=c.object({from:c.string(),to:c.string(),data:c.string()}),Zs=c.object({endpoint:js,body:c.object({id:c.string(),kind:c.string()})}),Js=c.object({action:_,chainId:Me,type:c.literal(de.enum.signature),data:c.object({signatureKind:zs,signatureData:c.union([Ys,$s]),postData:Zs})}),el=c.object({chainId:Me,action:_,data:Xs,type:c.literal(de.enum.transaction)}),tl=c.object({chainId:Me,action:_,type:c.literal(de.enum.refetch),data:c.object({resource:c.string()})}),ol=c.union([Js,el,tl]),il=c.object({action:_,chainId:lt,type:c.literal(de.enum.transaction),data:c.object({transaction:c.string()})}),nl=c.union([ol,il]),rl=c.object({steps:c.array(nl),orderId:c.string().optional()}),sl=new te("Failed to fetch collectible sell steps."),ll="collectible-instant-sell-steps",al=async e=>{try{let t=await k.api().validateStatus(!0).post("/collectibles/v1/sell",e);return rl.parse(t.data)}catch(t){if(he(t)){let o=t.response?.status;if(oe(t,o,ll),t.response?.data?.code){let{code:i}=t.response.data;throw{code:i}}if(o)throw t}throw sl}},So=({sellAsset:e})=>{let t=e.details.orderId!==void 0;return O({enabled:t,queryKey:x.collectibleSellSteps(e),staleTime:1/0,refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,retry:(o,i)=>i.code?!1:o<3,async queryFn(){return al(e)}})};var Dn=(e,t,o)=>{let i=o?.chainData,n=ne(i),r=K(i),s=o?.owner,u=n?s?.toLowerCase():s,m=t?.id,p=t?.source?.name,d=r?{minPrice:t?.price?.netAmount,tokenAccount:i.tokenAccount}:{};return{details:{asset:e,owner:u,orderId:m,marketplace:p,...d}}};l();a();fe.config({EXPONENTIAL_AT:1e3,DECIMAL_PLACES:78});function Ke(e,t){return new fe(e).div(new fe(10).pow(t)).toNumber()}var cl={steps:[],orderId:""},ul=({collectible:e})=>{let{t}=L(),o=(0,De.useMemo)(()=>Rt(e),[e]),i=(0,De.useMemo)(()=>Un(e),[e]),{data:n=[],isPending:r,isError:s}=yo({bidAsset:o,isEnabled:!i}),u=(0,De.useMemo)(()=>n.length>0?n[0]:void 0,[n]),m=(0,De.useMemo)(()=>Dn(o,u,e),[o,u,e]),{data:p=cl,isPending:d,isError:f,refetch:y,error:b}=So({sellAsset:m}),g=(0,De.useMemo)(()=>u&&e?Rn({t,bid:u,collectible:e}):void 0,[t,u,e]),h=(0,De.useMemo)(()=>f?Number.isInteger(b.code):!1,[f,b]);return{bid:u,bidSummary:g,isLoadingBids:r,isErrorBids:s,sellSteps:p,isLoadingSellSteps:d,isErrorSellSteps:f,refetchSellSteps:y,sellStepsError:b,isSellErrorCode:h,isListedOnSolana:i}},pl=({lastSale:e,receiveAmount:t})=>e!==void 0?t-e:t,Un=e=>{if(!e)return!1;let{listings:t,chainData:o}=e,n=(t?Object.keys(t):[]).length>0,r=o?K(o):!1;return n&&r},ml=({offerAmount:e,collectionFloor:t})=>e-t,dl=e=>{let t=Math.abs(e)<.001?"0.0000%":"0.00%",o=(0,kn.default)(e).format(t);return`${e>0?"+":""}${o}`},fl=e=>{if(e){let{price:t,token:o}=e,i=o?.decimals;if(i)return Ke(t,i)}},Cl=e=>{if(e){let{price:t,token:o}=e,i=o?.decimals;if(i)return Ke(t,i)}},bl=e=>{if(!e||!e.previews)return;let{previews:t}=e;if(t.small)return t.small;if(t.medium)return t.medium;if(t.large)return t.large};var Rn=({bid:e,collectible:t,t:o})=>{let{lastSalePrice:i,media:n,name:r,collection:s}=t,{name:u,logo:m}=e.source,{amount:p,netAmount:d,feeBreakdown:f,token:y,totalFeeBps:b}=e.price,{symbol:g,caip19:h}=y,A=0,P=d,j=s.id,M=t.id,G=Cl(i),X=g.slice(0,6),E=t.chain.symbol,ue=fl(s.floorPrice),B=ue?ml({offerAmount:p,collectionFloor:ue}):void 0,Q=B?dl(B):void 0;return{bidTokenSymbol:X,caip19:h,collectionId:j,collectibleId:M,orderId:e.id,collectibleChainId:t.chain.id,collectibleChainSymbol:E,collectionFloor:ue,collectibleImage:bl(n),collectibleName:r??o("collectiblesUnknownCollectible"),collectionName:s.name??o("collectiblesUnknownCollection"),currencySymbol:e.source.name==="Blur"?E:X,fees:f,floorDifference:B,floorDifferencePercent:Q,lastSale:G,marketplace:u,marketplaceLogoURL:m,offerAmount:p,offerAmountFormatted:rt(p),phantomFeePercentage:A,pnl:pl({lastSale:G,receiveAmount:P}),receiveAmount:P,receiveAmountFormatted:rt(P),totalFeeBps:b}},yl=({gasFee:e,totalFeeBps:t,offerAmount:o})=>{let i=En(t,o)+e.toNumber();return{raw:i,formatted:rt(i)}};l();a();var Ln=new Map([[_.enum["nft-approval"],8e4],[_.enum["blur-swap"],42e3],[_.enum.sale,39e4],["default",42e4]]),gl=(e,t,o,i)=>{let n=e==="Blur",r=o.filter(h=>h.type==="transaction").map(({action:h})=>({action:h}));if(r.some(({action:h})=>h===_.enum["nft-approval"])||(r=[...r,{action:_.enum["nft-approval"]}]),n){let h=r.some(({action:P})=>P===_.enum.sale),A=r.some(({action:P})=>P===_.enum["blur-swap"]);h||(r=[...r,{action:_.enum.sale}]),A||(r=[...r,{action:_.enum["blur-swap"]}])}let u=r?.reduce((h,{action:A})=>{let P=Ln.get(A)??Ln.get("default");return h+(P??0)},0),m=new R(u),{status:p,data:d}=Ei({gasLimit:m,networkID:t,transactionSpeed:"standard"}),{data:f}=Ii(t,d),y=ni(d),b=Number(y?.replace(/[^\d.]/g,"")??0),g=i?i.isGreaterThan(b):!1;return{gasEvm:b,gasEstimation:d,gasEstimationStatus:p,ethFeeUI:y,gasEstimationPrice:f,hasEnoughGas:g}};l();a();var be=S(T());l();a();var Lt=(e,t)=>{e.invalidateQueries({queryKey:co}),e.invalidateQueries({predicate:({queryKey:o})=>o.includes("collectibleSellSteps")&&o[2].details.orderId===t?.orderId})};var xl=()=>{let{data:e}=Ve();return(0,be.useMemo)(()=>{let o=e?.type,i=e?.name??"",n=e?.addresses??[],r=e?.identifier??"";return{isLedger:e?.type==="ledger",accountName:i,accountType:o,chainAddresses:n,accountIdentifier:r}},[e])},wl=({networkID:e,unsignedTransaction:t,pendingActivityRows:o,accountIdentifier:i,accountSigner:n,storage:r,includeCallPayload:s})=>({accountSigner:n,accountIdentifier:i,networkID:e,unsignedTransaction:t,...s&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:"sell",display:{summary:o}},storage:r}),El=async(e,t,o,i,n,r,s)=>{try{if(!o)throw new Error("Gas estimation is required");if(!s)throw new Error("Bid summary is required");let{data:u,chainId:m,action:p}=t,{collectionName:d,marketplace:f,receiveAmount:y,currencySymbol:b,collectibleChainSymbol:g,bidTokenSymbol:h}=s,A=nt(f),P={};p==="nft-approval"&&(P={topRight:{text:""},bottomRight:{text:""},topLeft:{text:e("collectiblesApproveCollection",{collectionName:d})},bottomLeft:{text:A}}),p==="sale"&&(P={topRight:{text:`+${y} ${b}`},topLeft:{text:e("collectiblesSoldCollectible")},bottomRight:{text:`-${d}`},bottomLeft:{text:A}}),p==="blur-swap"&&(P={topRight:{text:`+${y} ${g}`},topLeft:{text:e("transactionsSwapped")},bottomRight:{text:`-${y} ${h}`},bottomLeft:{text:A}});let j=Re.parse({type:"0x2",to:u.to,from:u.from,data:u.data,chainId:v.getEVMNetworkIDValue(m),gas:`0x${o.gasLimit.toString(16)}`,maxFeePerGas:`0x${o.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${o.maxPriorityFeePerGas.toString(16)}`}),M=wl({storage:i,accountSigner:n,pendingActivityRows:P,includeCallPayload:!1,networkID:m,unsignedTransaction:j,accountIdentifier:r.accountIdentifier}),G=await ui(M);return{type:t.type,data:G}}catch(u){return{type:t.type,error:u}}},vl=async(e,t,o)=>{try{let{chainId:i,data:n}=e,{signatureData:r,signatureKind:s,postData:u}=n;if(s==="eip191"&&"message"in r){let m=await t.sign(o.accountIdentifier,{signingType:"message",chainType:"eip155",message:r.message});if(m.status==="success")return await k.api().post("/collectibles/v1/submit-signature",{chainId:i,signature:m.signature,postData:u}),{type:e.type,data:"success"};throw new Error("Execute Sell: Couldn't sign message")}throw new Error("Execute Sell: EIP721 is not yet supported")}catch(i){return{type:e.type,error:i}}},Il=async(e,t)=>{try{let{resource:o}=e.data;if(o==="/sell"){let{data:i}=await t();return{type:e.type,data:i?.steps}}throw new Error("Execute Sell: Resource is not supported")}catch(o){return{type:e.type,error:o}}},Pl=[_.enum.auth,_.enum["nft-approval"],_.enum.sale],Dl="Steps are required",kl="These steps are not from the same bid",Bt=class extends Error{constructor(){super(...arguments);this.message=Dl}},Mt=class extends Error{constructor(){super(...arguments);this.message=kl}},Ul=(e,t,o,i,n,r,s)=>{let u=N(),m=H(),p=F(),d=Ne(),[f,y]=(0,be.useState)("idle"),[b,g]=(0,be.useState)(null),[h,A]=(0,be.useState)(null),{t:P}=L(),j=xl(),{chainAddresses:M,isLedger:G}=j;(0,be.useEffect)(function(){f==="loading"&&Lt(p,n)},[f,p,n]),(0,be.useEffect)(function(){f==="success"&&n&&_e(p,{id:n.collectibleId,amount:1})},[f,p,M,n]);let X=()=>{y("idle"),g(null),A(null)},E=s&&n?.receiveAmount?n.receiveAmount*s:void 0,ue=async(B,Q=new Map)=>{let V=B??t;try{if(e&&e!==""&&e!==n?.orderId)throw new Mt;if(!Array.isArray(V)||V.length===0)throw new Bt;y("loading");for await(let z of V){let{action:J}=z,zr=Q.get(J)==="success",$r=J===_.enum.sale,Io=J===_.enum.refetch,Yr=Pl.some(Ue=>Ue===J);if(zr)continue;Io||Q.set(J,"loading");let Xr=async Ue=>{switch(Ue.type){case de.enum.transaction:return await El(P,Ue,o,u,d,j,n);case de.enum.signature:return await vl(Ue,d,j);case de.enum.refetch:return await Il(Ue,i)}},{type:Po,data:zt,error:Do}=await Xr(z);if(Yr&&Do)throw Do;if(zt&&(Io||Q.set(J,"success"),Po===de.enum.transaction&&$r&&A(zt),Po===de.enum.refetch))return await Bo(500),await ue(zt,Q)}y("success"),m.capture("collectibleSellSuccess",{data:{bidSummary:n,usdSaleValue:E}})}catch(z){let J=z?.message??"";(!(z instanceof Bt)||!(z instanceof Mt))&&(D.captureError(z,"collectibles"),m.capture("collectibleSellFailure",{data:{bidSummary:n,usdSaleValue:E,errorMessage:J}})),y("error"),g(z)}};return{executeSellEvmSteps:ue,reset:X,error:b,result:h,status:f,isLedger:G}};l();a();var ce=S(T());var Rl=()=>{let{data:e}=Ve();return(0,ce.useMemo)(()=>{let o=e?.identifier??"",i=e?.type==="ledger",n=e?.addresses??[],r=n.find(_o),s=r?.networkID,u=r?.address??"",m=li(s),p=si(m);return{accountIdentifier:o,chainAddresses:n,chainId:s,solanaPublicKey:u,isLedger:i,cluster:m,connection:p}},[e])},Ll=(e,t)=>{let[o,i]=(0,ce.useState)(void 0);return(0,ce.useEffect)(()=>{(async()=>{if(!e)return;let s=e.find(d=>d.type==="transaction")?.data?.transaction;if(!s)return;let u=$t(s,"base64"),m=await Ci(t,[u.message]),p=ko(m.value);i(p)})()},[e,t]),o},Bl=async(e,t,o,i,n,r)=>{if(!r)throw new Error("Bid summary is required");let{collectionName:s,marketplace:u,receiveAmount:m,currencySymbol:p}=r,d={topRight:{text:`+${m} ${p}`},topLeft:{text:e("collectiblesSoldCollectible")},bottomRight:{text:`-${s}`},bottomLeft:{text:nt(u)}},{data:f,chainId:y,type:b}=t,{transaction:g}=f,h=$t(g,"base64"),A={ownerAddress:o.solanaPublicKey,networkID:y,data:{signature:""},type:"sell",display:{summary:d}},{accountIdentifier:P,solanaPublicKey:j,connection:M}=o,G=new w.PublicKey(j),X=await yi({accountIdentifier:P,feePayer:G,transaction:h,pendingTransactionInput:A,connection:M,accountSigner:i,storage:n,opts:{skipPreflight:!0}});return{type:b,data:X}},Ml="Steps are required",Ol="These steps are not from the same bid",Ot=class extends Error{constructor(){super(...arguments);this.message=Ml}},Nt=class extends Error{constructor(){super(...arguments);this.message=Ol}},Nl=(e,t,o,i)=>{let n=N(),r=H(),s=F(),u=Ne(),[m,p]=(0,ce.useState)("idle"),[d,f]=(0,ce.useState)(null),[y,b]=(0,ce.useState)(null),{t:g}=L(),h=Rl(),{chainId:A,connection:P,chainAddresses:j,isLedger:M}=h,G=A&&v.isSolanaNetworkID(A)?A:Oe.Solana.Mainnet,X=Ll(t,G);(0,ce.useEffect)(function(){m==="loading"&&Lt(s,o)},[m,s,o]),(0,ce.useEffect)(function(){m==="success"&&o&&_e(s,{id:o.collectibleId,amount:1})},[m,s,j,o]);let E=()=>{p("idle"),f(null),b(null)},ue=i&&o?.receiveAmount?o.receiveAmount*i:void 0;return{executeSellSolanaSteps:async()=>{try{if(e&&e!==o?.orderId)throw new Nt;if(!Array.isArray(t)||t.length===0)throw new Ot;p("loading");for await(let Q of t){let V=await Bl(g,Q,h,u,n,o);b(V.data),await bi({connection:P,signature:V.data})}p("success"),r.capture("collectibleSellSuccess",{data:{bidSummary:o,usdSaleValue:ue}})}catch(Q){let V=Q?.message??"";(!(Q instanceof Ot)||!(Q instanceof Nt))&&(D.captureError(Q,"collectibles"),r.capture("collectibleSellFailure",{data:{bidSummary:o,usdSaleValue:ue,errorMessage:V}})),p("error"),f(Q)}},reset:E,gas:X,error:d,result:y,status:m,isLedger:M}};l();a();var Vl=.01,Fl=e=>{let{fungible:t}=Bi({key:Oi(e.collectibleChainId,void 0)}),o=t?.data.balance;return{hasEnoughGas:o?o.isGreaterThan(Vl):!1}};l();a();var On=S(T()),Hl=e=>e.reduce((t,o)=>({...t,[o]:1}),{});function go({allCollections:e=[],pinnedCollectionIds:t=[],getIsHidden:o,getIsSpam:i}){let n=[],r=[],s=[],u=[],m=Hl(t),p={};for(let f of e)i(f)&&o(f)?u.push(f):o(f)?r.push(f):m[f.id]?p[f.id]=f:i(f)?s.push(f):n.push(f);let d=[];for(let f of t)p[f]&&d.push(p[f]);return{collections:[...d,...n,...s],hiddenCollections:r,spamCollections:u}}var _l=({allCollections:e=[],pinnedCollectionIds:t=[],getIsHidden:o,getIsSpam:i})=>(0,On.useMemo)(()=>go({allCollections:e,pinnedCollectionIds:t,getIsHidden:o,getIsSpam:i}),[e,o,i,t]);l();a();var Vt=S(T()),ho={location:0,distance:50,threshold:.3},If={...ho,keys:["name"]},Pf={...ho,keys:["name"]},Df={...ho,keys:["name"]},Je=(e,t)=>{if(t===void 0)return!1;let o=e.toLowerCase();return t.toLowerCase().split(" ").map(i=>i.startsWith(o)||o.startsWith(i)&&t.toLowerCase().includes(o)).includes(!0)};var Nn=(e,t)=>(0,Vt.useMemo)(()=>({collections:e.filter(i=>Je(t,i.name||i.items[0].name))}),[t,e]),Kl=(e,t,o,i)=>{let n=(0,Vt.useMemo)(()=>e.flatMap(r=>r.items),[e]);return(0,Vt.useMemo)(()=>{let r=e.filter(p=>Je(i,p.name)),s=n.filter(p=>Je(i,p.name)),u=t.filter(p=>Je(i,p.name)),m=o.filter(p=>Je(i,p.name));return{collections:r,collectibles:s,hiddenCollections:u,spamCollections:m}},[i,n,e,t,o])};l();a();var Ae=S(T());var ql=U({seconds:10}),Gl=U({seconds:5});function Ql({account:e}){let t=e?.identifier??"",o=e?.addresses??[],{data:i=[],isLoading:n}=ve({addresses:o,queryOptions:{staleTime:Gl,refetchInterval:ql}}),[r,s]=(0,Ae.useState)(""),u=Oo(r)??"",m=(0,Ae.useCallback)(M=>s(typeof M=="string"?M:M.currentTarget.value),[s]),{getIsHidden:p,getIsSpam:d,getSpamStatus:f,hideCollection:y,unhideCollection:b,isLoading:g}=An(t),h=(0,Ae.useMemo)(()=>{let{collections:M,hiddenCollections:G,spamCollections:X}=go({allCollections:i,getIsHidden:p,getIsSpam:d});return[...M,...G,...X]},[i]),A=Nn(h,u),P=(0,Ae.useCallback)(({item:M,status:G})=>G==="show"?b(M):y(M),[b,y]);return{viewState:(0,Ae.useMemo)(()=>({accountId:t,listItems:u?A.collections:h,searchQuery:r,debouncedSearchQuery:u,handleSearch:m,getIsHidden:p,getIsSpam:d,getSpamStatus:f,onToggleHidden:P}),[t,A.collections,r,m,h,P,p,d,f,u]),viewStateLoading:g||n}}l();a();var Vn={listCollectible:null,listCollectiblePrice:null,editListCollectiblePrice:null,unlistCollectible:null,transactionURL:null},ye=pt(e=>({...Vn,reset:()=>e({...Vn}),setListCollectible:t=>e({listCollectible:t}),setListPrice:t=>e({listCollectiblePrice:t}),setEditListPrice:t=>e({editListCollectiblePrice:t}),setUnlistCollectible:t=>e({unlistCollectible:t}),setTransactionURL:t=>e({transactionURL:t})}));l();a();var q=S(Jr());var Wl="token-account-min-balances",Fn=q.struct([q.blob(32,"mint"),q.blob(32,"owner"),q.nu64("amount"),q.blob(93)]),zf=q.struct([q.blob(44),q.u8("decimals"),q.blob(37)]),jl=q.struct([q.blob(679)]),zl=q.struct([q.u8("edition"),q.blob(281)]),$l=async e=>e.getMinimumBalanceForRentExemption(Fn.span).then(R),Yl=async e=>R(await e.getMinimumBalanceForRentExemption(jl.span)+await e.getMinimumBalanceForRentExemption(zl.span)+await e.getMinimumBalanceForRentExemption(Fn.span));function Xl({tokenEdition:e,connection:t}){return O({queryKey:[Wl,{tokenEdition:e}],queryFn:async()=>t?e===null||!xt(e)?$l(t):Yl(t):R(0)})}l();a();var Hn=S(T()),Zl=(e,t,o=!1,i)=>(0,Hn.useMemo)(()=>{if(e)return Ft({collectibleMedia:e,isImageAnimationEnabled:o,previewSize:i??"medium",mediaTypeOverride:t})},[e,t,o,i]),Ft=({collectibleMedia:e,isImageAnimationEnabled:t,previewSize:o,mediaTypeOverride:i})=>{let n=i??e.type;if((n==="image"||n==="other")&&e.previews?.[o]){let s=t?"":`${o==="medium"?"=":"-"}k`;return`${e.previews[o]}${s}`}return e[n]?.url};l();a();var _n=S(T());var Jl=!1,ea="small",ta="image",oa=e=>(0,_n.useMemo)(()=>Kn(e),[e]),Kn=(e,t=ea)=>{if(!e)return;let{media:o,collection:i}=e,n=Jl,r=ta;return o?Ft({collectibleMedia:o,isImageAnimationEnabled:n,previewSize:t,mediaTypeOverride:r}):i.imageUrl};l();a();var qn=S(T()),Gn=e=>{let{items:t}=e;if(t.length!==0)return t.find(({media:o})=>o?.type==="image")},ia=e=>(0,qn.useMemo)(()=>{if(e)return Gn(e)??e.items[0]},[e]);l();a();var Qn=S(T());var na=e=>(0,Qn.useMemo)(()=>{if(!(!e||e.items.length===0))return Wn(e)},[e]),Wn=e=>{let{items:t}=e,{length:o}=t;if(o===1){let[{balance:i="",chainData:n}]=t;if(K(n)&&n.standard==="SemiFungible"){let r=parseInt(i,10);return isNaN(r)?1:r}}return o};l();a();l();a();var jn={burnCollectibleTx:void 0,burnCollectibleTxFee:void 0},zn=e=>({...jn,resetBurnCollectible:()=>e({...jn}),setBurnCollectibleTx:t=>e({burnCollectibleTx:t}),setBurnCollectibleTxFee:t=>e({burnCollectibleTxFee:t})});l();a();var $n={multichainSellCollectible:void 0},Yn=e=>({...$n,resetMultichainSellCollectible:()=>e({...$n}),setMultichainSellCollectible:t=>e({multichainSellCollectible:t})});l();a();var Xn={listCollectible:null,listCollectiblePrice:null,editListCollectiblePrice:null,unlistCollectible:null,transactionURL:null},Zn=e=>({...Xn,reset:()=>e({...Xn}),setListCollectible:t=>e({listCollectible:t}),setListPrice:t=>e({listCollectiblePrice:t}),setEditListPrice:t=>e({editListCollectiblePrice:t}),setUnlistCollectible:t=>e({unlistCollectible:t}),setTransactionURL:t=>e({transactionURL:t})});l();a();var Jn={multichainListCollectible:null,multichainListCollectiblePrice:null,editMultichainListCollectiblePrice:null,unlistMultichainCollectible:null,multichainTransactionURL:null},er=e=>({...Jn,reset:()=>e({...Jn}),setMultichainListCollectible:t=>e({multichainListCollectible:t}),setMultichainListPrice:t=>e({multichainListCollectiblePrice:t}),setEditMultichainListPrice:t=>e({editMultichainListCollectiblePrice:t}),setUnlistMultichainCollectible:t=>e({unlistMultichainCollectible:t}),setMultichainTransactionURL:t=>e({multichainTransactionURL:t})});var ra=pt((e,t)=>({...Zn(e,t),...zn(e,t),...er(e,t),...Yn(e,t)}));l();a();l();a();var sa=500,tr=x.collections([])[1],la=[tr,x.hiddenCollections("")[1],x.unhiddenCollections("")[1],x.pinnedCollections("")[1]],aa=e=>{let t=String(e.queryKey[1]);return t===tr?e.state.data?.nrOfItems<=sa:la.includes(t)};l();a();var ar=S(T());l();a();l();a();l();a();var or="#F7931A",ca=5e4,ua="https://help.magiceden.io/en/articles/8450002-mastering-utxo-management-extracting-splitting-sats-on-magic-eden-bitcoin",ir={sendSuccessCondition:"SUBMISSION",displayFeeTooltip:!0,collectibleDetailPrecision:7,onBeforeSend:e=>e.multichainTransaction,collectibleDetailCtaBanner:(e,t)=>{let o=e.chainData;if(Tt(o)&&t){let i=new R(o.utxoDetails.value??0);if(i.lte(ca))return;let n=Object.values(o.utxoDetails.satributes).reduce((m,{count:p})=>m+p,0),r=Xt(n,v.bitcoin.tokenDecimals),s=Xt(i,v.bitcoin.tokenDecimals),u=No(s.minus(r).times(t));return{title:Z.t("collectibleDetailUtxoSplitterCtaTitle"),subtitle:Z.t("collectibleDetailUtxoSplitterCtaSubtitle",{value:u}),iconFill:or,modal:{title:Z.t("collectibleDetailUtxoSplitterModalCtaTitle"),subtitle:Z.t("collectibleDetailUtxoSplitterModalCtaSubtitle",{value:u}),buttonText:Z.t("collectibleDetailUtxoSplitterModalCtaButton"),uri:ua,iconFill:or}}}}};l();a();var et={sendSuccessCondition:"CONFIRMATION",displayFeeTooltip:!0,collectibleDetailPrecision:5,collectibleDetailCtaBanner:void 0,onBeforeSend({multichainTransaction:e,gasEstimation:t}){if(!ii(e))throw new Error("MultichainTransaction is not of type EVM");if(!t||!oi(t))throw new Error("No gas estimation found");return ci(e,t)}};l();a();var nr={sendSuccessCondition:"CONFIRMATION",displayFeeTooltip:!0,collectibleDetailPrecision:5,collectibleDetailCtaBanner:void 0,onBeforeSend:({multichainTransaction:e})=>e};var pa=new Qo({solana:nr,ethereum:et,polygon:et,base:et,monad:et,bitcoin:ir}),Se=Go(pa);l();a();var lr=S(T());l();a();var rr=S(Yt()),sr=({value:e,type:t})=>{if(!e)return"";try{switch(t){case"number":return(0,rr.default)(e).format("0,0.[00]").toString();case"date":return new Date(Number(e)).toLocaleDateString();default:return`${e}`}}catch{return`${e}`}};var Ao=e=>(0,lr.useMemo)(()=>{if(!e)return[];let t=e.chainData;return re(t)&&t.utxoDetails?t.utxoDetails.satributes.map(({count:o,displayName:i,description:n,url:r})=>({type:i.toUpperCase(),value:Z.t(ma(o,"collectibleDetailSatsCount_one","collectibleDetailSatsCount_other"),{count:o})??"",modal:{name:i,description:n,iconUrl:r}})):e.attributes.map(({trait_type:o,value:i,display_type:n})=>({type:o,value:sr({value:i,type:n})}))},[e]),ma=(e,t,o)=>e===1?t:o;function da(e){let{chain:t,owner:o}=e||{},i=t?.id,{data:n}=ut({address:o,networkID:i});ki(n);let r=Ao(e),s=i?v.getChainID(i):void 0,u=s?qo(s):void 0,{data:m}=vi({query:u?{data:u}:void 0});return{ctaBanner:(0,ar.useMemo)(()=>{if(!(!e||!m||!s))return Se.get(s).collectibleDetailCtaBanner?.(e,m.price)},[s,e,m]),traits:r}}l();a();var kr=S(T());l();a();function fa(e,t,o){let i=t.collectible;if(!i||!t.sendFormValues)throw new Error("State is missing necessary data");let{decimals:n="0"}=i,r=parseFloat(n),s=i.chainData,{mint:u,standard:m,tokenAccount:p,compression:d}=s,{amountAsset:f}=t.sendFormValues,y={networkID:i.chain.id,addressType:"solana",address:i.owner??""},b=xi(i);switch(m){case"NonFungible":case"NonFungibleEdition":case"ProgrammableNonFungible":case"ProgrammableNonFungibleEdition":return{type:"transferSPLToken",networkID:e,senderAddress:y,destination:o,amount:"1",senderAccount:p,mint:u,decimals:r,standard:m,compression:d,programId:s.programId,transferHookProgramId:b};case"SemiFungible":return{type:"transferSPLToken",networkID:e,senderAddress:y,destination:o,amount:f.isZero()?"1":f.toString(),senderAccount:p,mint:u,decimals:r,standard:m,programId:s.programId,transferHookProgramId:b};default:throw new Error("Unknown fungible token type")}}function Ca(e,t,o){let i=t.collectible;if(!i||!t.sendFormValues)throw new Error("State is missing necessary data");let{chainData:n}=i,{id:r,contract:s,standard:u}=n,{amountAsset:m}=t.sendFormValues,p={networkID:i.chain.id,addressType:"eip155",address:i.owner??""};switch(u){case"ERC721":return{type:"transferERC721Evm",networkID:e,senderAddress:p,destination:o,amount:1,contractAddress:s,tokenID:r};case"ERC1155":return{type:"transferERC1155Evm",networkID:e,senderAddress:p,destination:o,amount:m??"1",contractAddress:s,tokenID:r};default:throw new Error("Unknown fungible token type")}}function ba(e,t,o){let i=t.collectible;if(!i||!i.owner||!t.sendFormValues)throw new Error("State is missing necessary data");let{chainData:n}=i,{firstCreatedInscriptionId:r,utxoDetails:s,outputValue:u,utxoHash:m,utxoIndex:p}=n,d;if(s)d={type:"raresats",networkID:e,hash:s.hash,index:s.index,value:s.value.toString(),senderAddress:i.owner,destination:o,amount:1};else if(m&&p!==void 0)d={type:"ordinal",networkID:e,inscriptionId:r,value:u,amount:1,senderAddress:i.owner,destination:o,utxoHash:m,utxoIndex:p};else throw new Error(`Unable to determine transfer type for collectible: ${i.id}`);return d}function cr(e,t){let o=e?.collectible?.chain.id;if(o)return v.isBitcoinNetworkID(o)?ba(o,e,t):v.isSolanaNetworkID(o)?fa(o,e,t):v.isEVMNetworkID(o)?Ca(o,e,t):Le(o)}l();a();l();a();l();a();var ur=S(st()),pr=S(st()),mr=S(Vo()),dr=({value:e,senderAddress:t,destination:o,utxoState:{safeToSendUtxos:i},feerate:n,utxoHash:r,utxoIndex:s})=>{let u={transactionHash:r,index:s,value:e,isSafeToSend:!1,owner:t},m=[u],p=[{address:o,value:parseFloat(u.value),script:(0,mr.toOutputScript)(o)}],d=Ct(ct(Oe.Bitcoin.Mainnet,t),i,p,n,m),f=new pr.Psbt({network:ur.networks.bitcoin});if(d.type==="success"){let{inputs:y,outputs:b}=d;f.addInputs(y.map(g=>bt(g,t,!0))),f.addOutputs(b)}return[f,f.data.inputs.map((y,b)=>({address:t,signingIndexes:[b]})),d.vb]};l();a();var fr=S(st()),Cr=S(st()),br=S(Vo()),yr=({hash:e,index:t,value:o,senderAddress:i,destination:n,utxoState:{safeToSendUtxos:r},feerate:s})=>{let u={index:t,transactionHash:e,value:o,isSafeToSend:!1,owner:i},m=[u],p=[{address:n,value:parseFloat(u.value),script:(0,br.toOutputScript)(n)}],d=Ct(ct(Oe.Bitcoin.Mainnet,i),r,p,s,m),f=new Cr.Psbt({network:fr.networks.bitcoin});if(d.type==="success"){let{inputs:b,outputs:g}=d;f.addInputs(b.map(h=>bt(h,i,!0))),f.addOutputs(g)}let y=f.data.inputs.map((b,g)=>({address:i,signingIndexes:[g]}));return[f,y,d.vb]};function Sr(e,t,o){let i,n,r,s=o,u=Math.round(s?ei(s.btcPerKilobyte).toNumber():Jo);if(zi(e))[i,n,r]=dr({...e,utxoState:t,feerate:u});else if($i(e))[i,n,r]=yr({...e,utxoState:t,feerate:u});else return Le(e);return{networkID:e.networkID,psbt:i,vb:r,psbtChain:void 0,inputsToSign:n}}l();a();l();a();var ya=["function safeTransferFrom(address from, address to, uint256 tokenId)","function transferFrom(address from, address to, uint256 tokenId)"],gr=new Error("Error populating ERC721 transaction data."),hr=async e=>{let{sender:t,networkID:o,destination:i,contractAddress:n,tokenID:r,ethereumNetworkID:s}=e,u=dt(o,n,ya,t),m;try{let d=await u.populateTransaction.safeTransferFrom(t,i,new R(r).toString(10));if(d.data)m=d.data;else throw gr}catch{throw gr}return Re.parse({type:"0x2",from:t,to:n,chainId:typeof s=="number"?s:v.getEVMNetworkIDValue(s),data:m})};l();a();var Sa=["function safeTransferFrom(address from, address to, uint256 id, uint256 amount, bytes data)","function transferFrom(address from, address to, uint256 id, uint256 amount, bytes data)"],Tr=new Error("Error populating ERC1155 transaction data."),Ar=async e=>{let{sender:t,networkID:o,destination:i,contractAddress:n,tokenID:r,value:s,ethereumNetworkID:u}=e,m=dt(o,n,Sa,t),p;try{let f=await m.populateTransaction.safeTransferFrom(t,i,new R(r).toString(10),s.toString(10),[]);if(f.data)p=f.data;else throw Tr}catch{throw Tr}return Re.parse({type:"0x2",from:t,to:n,chainId:typeof u=="number"?u:v.getEVMNetworkIDValue(u),data:p})};async function xr(e){let t;if(qi(e)){let{networkID:o,senderAddress:i,destination:n,contractAddress:r,tokenID:s}=e;t=await hr({sender:i.address,networkID:o,destination:n,contractAddress:r,tokenID:s,value:1,ethereumNetworkID:o})}else if(Gi(e)){let{networkID:o,senderAddress:i,destination:n,contractAddress:r,tokenID:s,amount:u}=e;t=await Ar({sender:i.address,networkID:o,destination:n,contractAddress:r,tokenID:s,value:typeof u=="string"?new R(u,10):u,ethereumNetworkID:o})}else return Le(e);return{networkID:e.networkID,unsignedTransaction:t}}l();a();l();a();l();a();var Ht=class extends Error{constructor(t){super(t),this.name="ProofError"}};async function wr({networkID:e,mintAddress:t}){let o="/collectibles/v1/proof",i;try{i=await k.api().post(o,{chainId:e,address:t})}catch{let r=new Ht(`Failed to fetch proof for ${t} on network ${e}.`);throw D.captureError(r,"collectibles"),r}if(i.status!==200){let r=new Ht(`Failed to fetch proof for ${t} on network ${e}.`);throw D.captureError(r,"collectibles"),r}return await i.data}async function Er(e){let{senderAddress:t,mint:o}=e,i=new ee.Transaction,n=await wr({networkID:t.networkID,mintAddress:o});return i.add(await Yo({...e,...n})),i}l();a();async function vr({networkID:e,destination:t,mint:o,senderAddress:i}){let{createComputeBudgetIx:n,createOCPTransferIX:r,getOCPMintState:s}=await mt(),u=Fe(e),m=new w.PublicKey(o),p=await s(m,u);if(!p)throw new Error("Mint state not found for OCP transfer");it()&&console.log("This is a Magic Eden Open Creator Protocol Token");let d=new ee.Transaction;d.add(n());let{destinationAddress:f}=await yt({solanaConnection:u,destination:new w.PublicKey(t),mint:m,programId:je}),y=new w.PublicKey(i.address),{initAccountIX:b,transferIX:g}=await r({senderAddress:y,destinationAddress:f,mintAddress:m,mintState:p,connection:u});return b&&d.add(b),d.add(g),d}l();a();async function Ir({networkID:e,senderAddress:t,senderAccount:o,destination:i,mint:n}){let r=Fe(e),s=new w.PublicKey(n),{destinationAddress:u,destinationAccount:m}=await yt({solanaConnection:r,destination:new w.PublicKey(i),mint:s,programId:je}),{createPNFTTransferIX:p}=await mt(),d=new ee.Transaction,f=new w.PublicKey(t.address),y=new w.PublicKey(o),b=m;if(!b){let[g,h]=await mi(f,u,s,je);d.add(pi({account:u,owner:w.SystemProgram.programId})),d.add(g),b=h}return d.add(await p({senderAddress:f,tokenAccount:y,destinationAddress:u,destinationAccount:b,mintAddress:s,connection:r})),d}async function Pr(e){let{networkID:t,mint:o}=e,i=Fe(t),n;if(Qi(e))n=await Er(e);else if(Wi(e))n=await Ir(e);else if(ji(e)&&await Zo(new w.PublicKey(o),i))n=await vr({...e});else if(ti(e))n=await fi({...e,connection:i});else throw new Error("Unsupported transferSPLSolana args");let{memo:r}=e;return r&&n.add(di({memoText:r})),n.feePayer=new w.PublicKey(e.senderAddress.address),n=await ai(n,{connection:i}),n.recentBlockhash=(await i.getLatestBlockhash("confirmed")).blockhash,{networkID:e.networkID,transaction:[n]}}async function Dr(e,t,o){if(ga(e))return Pr(e);if(ha(e))return xr(e);if(Ta(e)){if(!t)throw new Error("Missing utxo state for Bitcoin transaction.");return Sr(e,t,o)}else throw new Error(`Unsupported transaction type: ${JSON.stringify(e)}`)}var ga=e=>v.isSolanaNetworkID(e.networkID),ha=e=>v.isEVMNetworkID(e.networkID),Ta=e=>v.isBitcoinNetworkID(e.networkID);var Aa="collectible-transfer-tx",xa=U({seconds:30});function wa(e){let{data:t}=Ve(),o=Ui(e?.sendFormValues?.recipient,e?.collectible?.chain.id)??"",i=(0,kr.useMemo)(()=>{if(t)return cr(e,o)},[t,e,o]),n=e?.collectible?.owner,{data:r}=ut({address:n,networkID:i?.networkID}),{data:s}=Di(r),u=e?.sendFormValues.transactionSpeed??"standard",{data:m}=wi({networkID:i?.networkID,enableFallback:!0}),p=m?m[u]:void 0;return O({staleTime:xa,enabled:Ea(i,s),queryKey:x.transferTransaction(i,p,s),async queryFn(){if(i)try{return await Dr(i,s,p)}catch(d){if(he(d)){let f=d.response?.status;oe(d,f,Aa,{})}throw d}}})}function Ea(e,t){return!e||v.isBitcoinNetworkID(e.networkID)&&!t?!1:!new fe(e.amount).isNaN()}l();a();var _t=e=>{let t=N();return O({enabled:e.length!==0,queryKey:x.hiddenCollections(e),gcTime:ae.Long,staleTime:1/0,async queryFn(){try{let o=await Ce(t,e);return Array.from(o.values()).filter(i=>St(i,{spamStatus:"NOT_VERIFIED"})).map(({id:i})=>i)}catch(o){return o instanceof Error&&D.captureError(o,"collectibles"),[]}}})};l();a();l();a();var Ur=S(T());var va=e=>{let t=F();return(0,Ur.useCallback)(()=>t.invalidateQueries({queryKey:x.collections(e)}),[t,e])};l();a();var Ia=2e3,Kt=class extends te{constructor(t){super(t),this.name="UsePinCollectionError"}};function qt(){let e=N(),t=F();return ie({async mutationFn({collectionId:o,accountId:i,pinned:n}){let r=await It(e)??{},s=r[i]??[];if(n){if(Object.values(r).flat().length+1>Ia)throw new Kt("Pinned limit reached");let m=[...new Set([...s,o])],p={...r,[i]:m};await fo(e,p)}else{let u=s.indexOf(o);if(u===-1)throw new Kt("Collection not previously pinned");let m=[...s];m.splice(u,1);let p={...r,[i]:m};await fo(e,p)}},async onSuccess(o,i){await t.invalidateQueries({queryKey:x.pinnedCollections(i.accountId)})}})}l();a();var Rr=S(T());var Pa=e=>{let t=F();return(0,Rr.useCallback)(()=>t.refetchQueries({queryKey:x.collections(e)}),[t,e])};l();a();l();a();var Da=new Error("Failed to report event for collectible");async function Lr(e){try{let t=await k.api().post("/collectibles/v1/events",{events:e});if(!ge(t))throw new Error}catch{throw Da}}function Br(){return ie({async mutationFn({event:e}){try{await Lr([e])}catch{}}})}l();a();function ka(){let{data:e}=$o(),t=N(),o=F(),i=Pi(),n=Ne();return ie({mutationFn:async({multichainTransaction:s,pendingTransactionInput:u,senderAddress:m,optimisticUpdate:p,gasEstimation:d})=>{if(!e)throw new Error("No account identifier found");let{networkID:f}=s,y=Se.get(f).onBeforeSend({multichainTransaction:s,gasEstimation:d})??s,b=await gi({accountIdentifier:e,accountSigner:n,multichainTransaction:y,networkID:f,pendingTransactionInput:u,senderAddress:m,storage:t,utxoManager:i});return p&&_e(o,p),Si(f,b)},onError(s){s instanceof Error&&D.captureError(s,"collectibles")}})}l();a();var Gt=e=>{let t=N();return O({enabled:e.length!==0,queryKey:x.unhiddenCollections(e),gcTime:ae.Long,staleTime:1/0,async queryFn(){try{let o=await Ce(t,e);return Array.from(o.values()).filter(i=>Li(i,{spamStatus:"NOT_VERIFIED"})).map(({id:i})=>i)}catch(o){return o instanceof Error&&D.captureError(o,"collectibles"),[]}}})};l();a();var Ua=2e3,xo=class extends Error{constructor(t){super(t),this.name="UseUnhideCollectionError"}};function Qt(){let e=N(),t=F(),o=H();return ie({async mutationFn(i){let{collectionId:n,accountId:r}=i,s=await Zt(e);if(!(await Ce(e,r)).has(n)&&s>=Ua)throw new xo("Too many ids unhidden");await $e(e,o,{accountId:r,mutations:[{id:n,visibility:"visible"}]})},async onSuccess(i,n){await t.invalidateQueries({queryKey:x.unhiddenCollections(n.accountId)}),await t.invalidateQueries({queryKey:x.hiddenCollections(n.accountId)})}})}l();a();var ke=S(T());l();a();var wo=S(T());var Mr=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,wo.useCallback)(({collectible:s,previousVisibility:u,updatedVisibility:m})=>{m!==null&&i.capture("collectiblesReportAsNotSpam",{data:Te(s)}),e.success(u==="visible"?o("collectiblesNotSpamSuccess"):o("collectiblesNotSpamAndUnhiddenSuccess"))},[o,e,i]),r=(0,wo.useCallback)((s,u)=>{e.error(o("collectiblesNotSpamFail"))},[o,e]);return fn({accountId:t,onSuccess:n,onError:r})};l();a();var Eo=S(T());var Or=({toast:e,accountId:t})=>{let{t:o}=L(),i=H(),n=(0,Eo.useCallback)(({collectible:s,previousVisibility:u,updatedVisibility:m})=>{m!==null&&i.capture("collectiblesReportAsSpam",{data:Te(s)}),e.success(u==="hidden"?o("collectiblesSpamSuccess"):o("collectiblesSpamAndHiddenSuccess"))},[o,e,i]),r=(0,Eo.useCallback)((s,u)=>{e.error(o("collectiblesSpamFail"))},[o,e]);return dn({accountId:t,onSuccess:n,onError:r})};function Ra({accountId:e,collectible:t,toast:o}){let i=Or({collectible:t,accountId:e,toast:o}),n=(0,ke.useCallback)(()=>{if(t)return i(t)},[i,t]),r=Mr({collectible:t,accountId:e,toast:o}),s=(0,ke.useCallback)(()=>{if(t)return r(t)},[r,t]),{data:u}=Y(e??""),m=(0,ke.useMemo)(()=>u?.get(t?.collection.id??t?.id??""),[u,t]),p=(0,ke.useMemo)(()=>t?Ri(m,{spamStatus:t.collection.spamStatus}):"NOT_VERIFIED",[t,m]),d=Ye(p);return(0,ke.useMemo)(()=>({isSpam:d,spamStatus:p,onReportSpam:d?void 0:n,onReportNotSpam:d?s:void 0}),[p,d,n,s])}l();a();var Nr=S(Yt()),Vr=S(T());l();a();var Wt=(e,t)=>{let o=new fe(e);if(o.isZero())return"0";let i=new fe(10).pow(-t);return o.abs().lt(i)?o.isPositive()?`<${i.toFixed()}`:`-<${i.toFixed()}`:parseFloat(o.toString()).toLocaleString("en-US",{maximumFractionDigits:t})};var La=(e,t)=>{let{t:o}=L();return(0,Vr.useMemo)(()=>{let n=[];if(!e)return n;let r=e?.chain.id,s=Se.get(r).collectibleDetailPrecision;e.collection.name&&n.push({label:o("collectibleScreenCollectionLabel"),value:e.collection.name});let u,m;if(e.collection.floorPrice){let{price:f,token:y}=e.collection.floorPrice;if(y&&y.decimals&&y.symbol){let{decimals:b,symbol:g}=y,h=Ke(f,b);n.push({label:o("collectiblesFloorPrice"),value:`${Wt(h,s)} ${g}`}),u=h,m=g}}let p,d;if(e.lastSalePrice){let{price:f,token:y}=e.lastSalePrice;if(y&&y.decimals&&(y.symbol||y.name)){let{decimals:b,symbol:g,name:h}=y,A=Ke(f,b);n.push({label:o("collectiblesLastSalePrice"),value:`${Wt(A,s)} ${g??h}`}),p=A,d=g}}if(u&&p&&m===d){let f=u-p;n.push({label:o("collectiblesTotalReturn"),value:`${Wt(f,s)} ${d}`,color:f>0?t?.positiveColor:f===0?void 0:t?.negativeColor})}return e.collection.ownerCount&&n.push({label:o("collectiblesUniqueHolders"),value:(0,Nr.default)(e.collection.ownerCount).format("0,0")}),e.chain.name&&n.push({label:o("sendFungibleSummaryNetwork"),value:v.getNetworkName(e.chain.id)}),it()&&n.push({label:"Standard",value:Ba(e)}),Ai(e)&&n.push({label:o("collectiblesNonTransferable"),value:o("collectiblesNonTransferableYes")}),n},[e,t?.negativeColor,t?.positiveColor,o])};function Ba(e){let t=e.chainData;if(K(t))return t.standard;if(ne(t))return t.standard;if(re(t))return"Ordinals"}l();a();var Hr=S(T());l();a();var Ma=S(T());l();a();var Oa=S(T());l();a();var Fr=S(T()),jt=(e,t,o,i)=>(0,Fr.useMemo)(()=>t.includes(o)?!1:e.includes(o)?!0:!!i,[e,t,o,i]);l();a();var tt=S(T());l();a();var _r=S(T()),vo=({accountId:e,collectionId:t,isPinned:o,pinMessages:i,pinCollection:n,toast:r,sendAnalyticEvent:s,unhideCollection:u,isHidden:m})=>(0,_r.useCallback)(()=>{(async()=>{if(!t||!e){r.error(o?i.unpinFail:i.pinFail);return}try{await n({collectionId:t,accountId:e,pinned:!o}),m&&!o&&await u({collectionId:t,accountId:e}),r.success(o?i.unpinSuccess:i.pinSuccess),s&&s(o?"collectionUnpinned":"collectionPinned")}catch{r.error(o?i.unpinFail:i.pinFail)}})()},[t,e,o,i,n,r,s,u,m]);var Ha=({collectionId:e,isSpam:t,accountId:o,networkId:i,toast:n})=>{let{t:r}=L(),s=H(),{mutateAsync:u}=Qt(),{data:m=[]}=_t(o||""),{data:p=[]}=Gt(o||""),d=jt(m,p,e??"",!!t),{mutateAsync:f}=qt(),{data:y=[]}=Pt(o||""),b=Ut(y,e??""),g=(0,tt.useMemo)(()=>({pinSuccess:r("collectionPinSuccess"),pinFail:r("collectionPinFail"),unpinSuccess:r("collectionUnpinSuccess"),unpinFail:r("collectionUnpinFail")}),[r]),h=(0,tt.useCallback)(P=>{i&&s.capture(P,{data:{networkId:i,chainId:v.getChainID(i)}})},[s,i]),A=vo({accountId:o,collectionId:e,isPinned:b,pinMessages:g,pinCollection:f,toast:n,sendAnalyticEvent:h,unhideCollection:u,isHidden:d});return(0,tt.useMemo)(()=>({isPinned:b,onTogglePin:A}),[b,A])};l();a();var ot=S(T());var _a=({networkID:e,isTxError:t,isTxConfirmed:o,isTxSubmitted:i})=>{let n=Se.get(e).sendSuccessCondition,r=(0,ot.useMemo)(()=>t?"ERROR":n==="SUBMISSION"&&i||n==="CONFIRMATION"&&o?"SUCCESS":"LOADING",[o,t,i,n]),s=n==="CONFIRMATION"?"sendStatusConfirmedSuccessTitle":"sendStatusSubmittedSuccessTitle",u=(0,ot.useMemo)(()=>{switch(r){case"LOADING":return Z.t("sendStatusLoadingTitle");case"ERROR":return Z.t("sendStatusErrorTitle");case"SUCCESS":return Z.t(s)}},[r,s]),{isError:m,isSuccess:p}=(0,ot.useMemo)(()=>({isError:r==="ERROR",isSuccess:r==="SUCCESS"}),[r]),{transactionSpeed:d="standard"}=Ni(y=>y.sendFormValues),f=(0,ot.useMemo)(()=>{let y=ri.get(e).transactionSpeedDescription(d);return y?Z.t(y):""},[e,d]);return{title:u,isError:m,isSuccess:p,sendSuccessCondition:n,estimatedTime:f}};l();a();var qe=S(T());var Ka=()=>{let e=ye(p=>p.listCollectible),t=ye(p=>p.editListCollectiblePrice),[o,i]=(0,qe.useState)(),[n,r]=(0,qe.useState)(!1),[s,u]=(0,qe.useState)();return{editList:(0,qe.useCallback)(async(p,d)=>{if(i(void 0),r(!0),!e||!t){i(new Error("missing collectible or price")),r(!1);return}try{let f=new URLSearchParams;f.set("pubKey",d.toBase58()),f.set("mint",e.asset.mintPubKey),f.set("account",e.asset.pubkey),f.set("quotePrice",`${At(t)}`),f.set("marketplace","magic_eden");let y=pe(p);f.set("chainId",y.toString());let b=`/solana/composer/v1/list?${f.toString()}`,h=(await k.api().retry(3,2e3).get(b)).data,A=ee.Transaction.from(Buffer.from(h.transaction,"base64"));He(A)?u(A):i(new Error("Failed to initialize transaction")),r(!1)}catch(f){console.error(f),i(new Error("Failed to initialize transaction")),r(!1)}},[e,t]),isLoading:n,error:o,transaction:s}};l();a();var Ge=S(T());var qa=()=>{let e=ye(p=>p.listCollectible),t=ye(p=>p.listCollectiblePrice),[o,i]=(0,Ge.useState)(),[n,r]=(0,Ge.useState)(!1),[s,u]=(0,Ge.useState)();return{list:(0,Ge.useCallback)(async(p,d)=>{if(i(void 0),r(!0),!e||!t){i(new Error("missing collectible or price")),r(!1);return}try{let f=new URLSearchParams;f.set("pubKey",d.toBase58()),f.set("mint",e.asset.mintPubKey),f.set("account",e.asset.pubkey),f.set("quotePrice",`${At(t)}`),f.set("marketplace","magic_eden");let y=pe(p);f.set("chainId",y.toString());let b=`/solana/composer/v1/list?${f.toString()}`,h=(await k.api().retry(3,2e3).get(b)).data,A=ee.Transaction.from(Buffer.from(h.transaction,"base64"));He(A)?u(A):i(new Error("Failed to initialize transaction")),r(!1)}catch(f){i(new Error("Failed to initialize transaction")),r(!1),D.captureError(f,"magicEden")}},[e,t]),isLoading:n,error:o,transaction:s}};l();a();var Qe=S(T());var Ga=()=>{let e=ye(m=>m.unlistCollectible),[t,o]=(0,Qe.useState)(),[i,n]=(0,Qe.useState)(!1),[r,s]=(0,Qe.useState)();return{unlist:(0,Qe.useCallback)(async(m,p)=>{if(o(void 0),n(!0),!e){o(new Error("missing collectible")),n(!1);return}try{let d=new URLSearchParams;d.set("pubKey",p.toBase58()),d.set("mint",e.asset.mintPubKey),d.set("account",e.asset.pubkey),d.set("marketplace","magic_eden");let f=pe(m);d.set("chainId",f.toString());let y=`/solana/composer/v1/unlist?${d.toString()}`,g=(await k.api().retry(3,2e3).get(y)).data,h=ee.Transaction.from(Buffer.from(g.transaction,"base64"));He(h)?s(h):o(new Error("Failed to initialize transaction")),n(!1)}catch(d){o(new Error("Failed to initialize transaction")),n(!1),D.captureError(d,"magicEden")}},[e]),isLoading:i,error:t,transaction:r}};l();a();var Kr=S(T()),Qa=e=>(0,Kr.useMemo)(()=>e.filter(t=>t?.media?.type==="image"),[e]);l();a();var qr=S(T());var Wa=(e,t)=>(0,qr.useMemo)(()=>{if(!e||!t)return;let o=e.chain.id,i=t.explorers[o]??Wo.get(o).defaultExplorer,n,r;if(K(e.chainData))r="address",n=e.chainData.mint;else if(ne(e.chainData))if(e.chainData.contract)e.chainData.id?(r="nft",n=[e.chainData.contract,e.chainData.id]):(r="token",n=e.chainData.contract);else return;else if(re(e.chainData))if(Tt(e.chainData)){let{hash:u,index:m}=e.chainData.utxoDetails;r="transaction",n=`${u}#flow=&vout=${m}`}else return{name:"Ordinals",url:`https://ordinals.com/inscription/${e.chainData.firstCreatedInscriptionId}`};else throw new Error(`Unhandled collectible explorer for chain id: ${e.chain.id}`);if(!n)return;let s=zo({networkID:o,endpoint:r,explorerType:i,param:n});if(s)return{name:jo[i],url:s}},[e,t]);l();a();var Gr=S(T()),ja=e=>(0,Gr.useMemo)(()=>{let t=new Set;return e.filter(o=>{if(!o?.media?.image?.url)return!1;let{url:i}=o.media.image;return t.has(i)?!1:(t.add(i),!0)})},[e]);l();a();var Qr=S(T());var za=e=>{let{t}=L();return(0,Qr.useMemo)(()=>{let i=[];if(!e)return;let n=e.chainData;if(re(n)){let{outputValue:r,satNumber:s,satName:u,inscriptionId:m,inscriptionNumber:p,protocolName:d,createdAt:f,utxoDetails:y}=n,b=t(m?"collectibleDetailOrdinalInfo":"collectibleDetailRareSatsInfo"),g;return r?g=parseFloat(r).toLocaleString("en-US"):y&&(g=y.value.toLocaleString("en-US")),i.push(g?{label:t("collectibleDetailSatsInUtxo"),value:t("collectibleDetailSatsInUtxoValue",{satsInUtxo:g})??void 0}:null),i.push(s?{label:t("collectibleDetailSatNumber"),value:s}:null),i.push(u?{label:t("collectibleDetailSatName"),value:u}:null),i.push(m?{label:t("collectibleDetailInscriptionId"),value:Mo(m,5,3)}:null),i.push(p?{label:t("collectibleDetailInscriptionNumber"),value:p}:null),i.push(d?{label:t("collectibleDetailStandard"),value:d?.toUpperCase()}:null),i.push(f?{label:t("collectibleDetailCreated"),value:$a(new Date(f))}:null),{label:b,items:i.filter(Ro)}}},[e,t])};function $a(e){let t=e.toLocaleDateString(void 0,{month:"numeric",day:"numeric",year:"numeric"}),o=e.toLocaleTimeString();return`${t} ${o}`}l();a();var jr=S(T()),xe=()=>{},Wr=new Map([["send",1],["list",2],["pin",3],["unpin",4],["share",5],["setAsAvatar",6],["saveToLibrary",7],["hide",8],["reportAsSpam",9],["reportAsNotSpam",10],["burnToken",11],["viewOnExplorer",12]]);function Ya(e){let{amountToBurn:t=0,explorerName:o,isBurnable:i,isHidden:n,isPinned:r,isSpam:s,onBurnToken:u,onList:m,onReportNotSpam:p,onReportSpam:d,onSaveToLibrary:f,onSend:y,onSetAsAvatar:b,onShare:g,onToggleHide:h,onTogglePin:A,onViewOnExplorer:P,shortcuts:j,shouldDisplaySend:M,shouldDisplayShortcuts:G,shouldDisplayListOnSolana:X}=e,{t:E}=L();return(0,jr.useMemo)(()=>{let B=[];if(M&&B.push({text:E("commandSend"),type:"send",onClick:y??xe}),X&&B.push({text:E("collectibleDetailList"),type:"list",onClick:m}),f&&B.push({text:E("assetDetailSaveToPhotos"),singleWordAltText:E("commandSave"),type:"saveToLibrary",menuOnly:!0,onClick:f??xe}),b&&!s&&B.push({text:E("collectibleDetailSetAsAvatar"),singleWordAltText:E("collectibleDetailSetAsAvatarSingleWorkAlt"),type:"setAsAvatar",menuOnly:!0,onClick:b??xe}),g&&B.push({text:E("collectibleDetailShare"),singleWordAltText:E("commandShare"),type:"share",menuOnly:!0,onClick:g??xe}),A){let V=E(r?"assetDetailUnpinCollection":"assetDetailPinCollection"),z=E(r?"commandUnpin":"commandPin"),J=r?"unpin":"pin";B.push({text:V,singleWordAltText:z,type:J,menuOnly:!0,onClick:A??xe})}if(h){let V=E(n?"assetDetailUnhideCollection":"assetDetailHideCollection"),z=E(n?"commandUnhide":"commandHide"),J=n?"unhide":"hide";B.push({text:V,singleWordAltText:z,type:J,menuOnly:!0,onClick:h??xe})}if(p){let V=E("collectiblesReportAsNotSpam");B.push({text:V,type:"reportAsNotSpam",singleWordAltText:E("collectiblesReportNotSpam"),menuOnly:!0,isDestructive:!0,onClick:p})}if(d){let V=E("collectiblesReportAsSpam");B.push({text:V,type:"reportAsSpam",singleWordAltText:E("commandReport"),menuOnly:!0,isDestructive:!0,onClick:d})}if(i){let V=E(t===1?"collectibleBurnTitleWithCount_one":"collectibleBurnTitleWithCount_other");B.push({text:V,singleWordAltText:E("commandBurn"),type:"burnToken",menuOnly:!0,isDestructive:!0,onClick:u??xe})}return!!P&&!!o&&B.push({text:E("assetDetailViewOnExplorer",{explorer:o}),singleWordAltText:E("commandView"),type:"viewOnExplorer",menuOnly:!0,onClick:P??xe}),B.sort((V,z)=>(Wr.get(V.type)??100)-(Wr.get(z.type)??100)),{actions:Mi(B,4),shortcuts:G?j:[]}},[t,o,i,n,r,s,u,m,p,d,f,y,b,g,h,A,P,j,M,G,X,E])}l();a();export{ss as a,Ec as b,xt as c,Bc as d,Xi as e,Mc as f,K as g,ne as h,re as i,Tt as j,Is as k,Ds as l,ks as m,Us as n,Rs as o,aa as p,da as q,wr as r,wa as s,ve as t,Ms as u,va as v,Pt as w,Pa as x,Br as y,ka as z,Os as A,Ns as B,Vs as C,Tn as D,Ra as E,La as F,Fs as G,Ut as H,Mm as I,En as J,ul as K,yl as L,gl as M,Ul as N,Ol as O,Nl as P,Fl as Q,_l as R,Kl as S,Ql as T,Ha as U,_a as V,ye as W,Ka as X,qa as Y,Ga as Z,Xl as _,Zl as $,oa as aa,ia as ba,na as ca,Qa as da,Wa as ea,ja as fa,za as ga,Ya as ha,ra as ia};
//# sourceMappingURL=chunk-PN7XAO7F.js.map
